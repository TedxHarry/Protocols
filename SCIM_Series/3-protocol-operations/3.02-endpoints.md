# 🏆 Section 3.02 | Protocol Operations | “Endpoints”

---

## 📌 At a glance
SCIM defines a set of **standard REST endpoints** for managing identity resources.  
Each endpoint exposes specific functionality for users, groups, schemas, and service provider configuration.  

---

## 📖 What are SCIM Endpoints?
Endpoints are the **entry points for SCIM operations**.  
They define where clients (IdPs) send requests to manage resources like Users and Groups.

> **Notes**
- Defined in **RFC 7644**.  
- Core endpoints: `/Users`, `/Groups`, `/Schemas`, `/ServiceProviderConfig`.  
- Optional endpoints: `/ResourceTypes`, `/Bulk`.  

---

## 🔑 Key characteristics
- **/Users** → CRUD operations for user accounts.  
- **/Groups** → CRUD operations for groups and memberships.  
- **/Schemas** → Returns schema definitions supported by the SP.  
- **/ServiceProviderConfig** → Tells client what features are supported.  
- **/ResourceTypes** → Describes resource types and their endpoints.  
- **/Bulk** → Allows batching multiple operations in one request.  

---

## 🌍 Why it matters (and how it helps you later)
- Endpoints are the **map of SCIM’s functionality**.  
- They tell you what you can provision, update, and query.  
- As an IAM engineer, knowing the endpoints helps you quickly troubleshoot → e.g., “Does this SP even support PATCH?” → Check `/ServiceProviderConfig`.  
- Mastering endpoints prepares you for deeper dives into CRUD, filtering, and bulk operations.  

---

## 🛠️ Where it’s used (flows + impact)

### Example Flow
```
Okta (Client) → SCIM Endpoints → SaaS App
```

- `POST /Users` → Creates a user in the app.  
- `PATCH /Groups` → Updates group membership.  
- `GET /Schemas` → Client learns required/optional attributes.  
- `GET /ServiceProviderConfig` → Client knows which methods vendor supports.  

Impact: Endpoints ensure **predictability**. Without them, IdPs would rely on vendor-specific APIs.  

---

## 🔗 How this links to other concepts
- [3.01 Protocol Overview](3.01-protocol-overview.md) → Introduced the protocol; endpoints are where it comes alive.  
- [3.04 CRUD Operations](3.04-crud-operations.md) → Explains how HTTP methods apply to these endpoints.  
- [3.05 Filtering](3.05-filtering.md) → Shows how to query users and groups at `/Users` and `/Groups`.  

---

## ⚙️ Technical deep dive

### Example: /Users endpoint (GET)
```http
GET /Users?filter=userName eq "bjensen"
Authorization: Bearer <token>
```

### Example: /Groups endpoint (PATCH)
```http
PATCH /Groups/c3d1d3f2
Content-Type: application/scim+json

{
  "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
  "Operations": [{
    "op": "add",
    "path": "members",
    "value": [{ "value": "2819c223-7f76-453a-919d-413861904646" }]
  }]
}
```

### Example: /ServiceProviderConfig
```json
{
  "patch": { "supported": true },
  "bulk": { "supported": false },
  "filter": { "supported": true, "maxResults": 200 },
  "changePassword": { "supported": true },
  "sort": { "supported": true }
}
```

**Key points**:  
- Always check `/ServiceProviderConfig` before assuming vendor support.  
- Use `/Schemas` to confirm attribute definitions.  
- Use `/ResourceTypes` for resource discovery.  

---

## 🏢 Real-world scenario
A company integrates Azure Entra ID with Zoom via SCIM.  

- Azure checks Zoom’s `/ServiceProviderConfig` → learns PATCH is supported, but Bulk is not.  
- Azure fetches `/Schemas` → maps attributes correctly.  
- Azure provisions users into Zoom via `/Users`.  

**Impact:** Integration worked first try, with no guesswork about vendor capabilities.  

---

## ❌ Common pitfalls
- Ignoring `/ServiceProviderConfig` → Leads to failed operations.  
- Assuming Bulk is supported everywhere.  
- Not fetching `/Schemas` → Causes attribute mismatches.  
- Forgetting to page results from `/Users` or `/Groups`.  
- Confusing `/ResourceTypes` with `/Schemas`.  

---

## ⚠️ Risks & issues

| Risk | Impact | Mitigation |
|------|--------|------------|
| Vendor hides unsupported features | Provisioning fails | Check `/ServiceProviderConfig` first |
| Missing schema fetch | Wrong attribute mapping | Always call `/Schemas` before mapping |
| Large result sets | Partial sync | Implement pagination and sorting |
| Assuming bulk ops | Failed requests | Verify Bulk support explicitly |

**Real-world:** A team assumed Bulk was supported by their SaaS app. Their provisioning failed until they discovered `/ServiceProviderConfig` explicitly listed Bulk as unsupported.  

---

## 📝 Mini quiz
1. Which SCIM endpoint provides supported features like PATCH or Bulk?  
   a) `/Schemas`  
   b) `/Users`  
   c) `/Groups`  
   d) `/ServiceProviderConfig`  

2. Which endpoint lists attributes required for User objects?  
   a) `/Users`  
   b) `/Groups`  
   c) `/Schemas`  
   d) `/ResourceTypes`  

3. Scenario: A provisioning integration fails because PATCH isn’t supported. Which endpoint should you check first?  
   a) `/Schemas`  
   b) `/ServiceProviderConfig`  
   c) `/Bulk`  
   d) `/Groups`  

---

## 🔗 Navigation
👉 Back: [3.01 Protocol Overview](3.01-protocol-overview.md)  
👉 Next: [3.03 HTTP Methods](3.03-http-methods.md)  

➡️ Next, we’ll explore **HTTP Methods (3.03)** to understand how SCIM uses POST, PUT, PATCH, and DELETE for lifecycle operations.
