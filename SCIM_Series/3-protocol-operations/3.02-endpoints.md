# ğŸ† Section 3.02 | Protocol Operations | â€œEndpointsâ€

---

## ğŸ“Œ At a glance
SCIM defines a set of **standard REST endpoints** for managing identity resources.  
Each endpoint exposes specific functionality for users, groups, schemas, and service provider configuration.  

---

## ğŸ“– What are SCIM Endpoints?
Endpoints are the **entry points for SCIM operations**.  
They define where clients (IdPs) send requests to manage resources like Users and Groups.

> **Notes**
- Defined in **RFC 7644**.  
- Core endpoints: `/Users`, `/Groups`, `/Schemas`, `/ServiceProviderConfig`.  
- Optional endpoints: `/ResourceTypes`, `/Bulk`.  

---

## ğŸ”‘ Key characteristics
- **/Users** â†’ CRUD operations for user accounts.  
- **/Groups** â†’ CRUD operations for groups and memberships.  
- **/Schemas** â†’ Returns schema definitions supported by the SP.  
- **/ServiceProviderConfig** â†’ Tells client what features are supported.  
- **/ResourceTypes** â†’ Describes resource types and their endpoints.  
- **/Bulk** â†’ Allows batching multiple operations in one request.  

---

## ğŸŒ Why it matters (and how it helps you later)
- Endpoints are the **map of SCIMâ€™s functionality**.  
- They tell you what you can provision, update, and query.  
- As an IAM engineer, knowing the endpoints helps you quickly troubleshoot â†’ e.g., â€œDoes this SP even support PATCH?â€ â†’ Check `/ServiceProviderConfig`.  
- Mastering endpoints prepares you for deeper dives into CRUD, filtering, and bulk operations.  

---

## ğŸ› ï¸ Where itâ€™s used (flows + impact)

### Example Flow
```
Okta (Client) â†’ SCIM Endpoints â†’ SaaS App
```

- `POST /Users` â†’ Creates a user in the app.  
- `PATCH /Groups` â†’ Updates group membership.  
- `GET /Schemas` â†’ Client learns required/optional attributes.  
- `GET /ServiceProviderConfig` â†’ Client knows which methods vendor supports.  

Impact: Endpoints ensure **predictability**. Without them, IdPs would rely on vendor-specific APIs.  

---

## ğŸ”— How this links to other concepts
- [3.01 Protocol Overview](3.01-protocol-overview.md) â†’ Introduced the protocol; endpoints are where it comes alive.  
- [3.04 CRUD Operations](3.04-crud-operations.md) â†’ Explains how HTTP methods apply to these endpoints.  
- [3.05 Filtering](3.05-filtering.md) â†’ Shows how to query users and groups at `/Users` and `/Groups`.  

---

## âš™ï¸ Technical deep dive

### Example: /Users endpoint (GET)
```http
GET /Users?filter=userName eq "bjensen"
Authorization: Bearer <token>
```

### Example: /Groups endpoint (PATCH)
```http
PATCH /Groups/c3d1d3f2
Content-Type: application/scim+json

{
  "schemas": ["urn:ietf:params:scim:api:messages:2.0:PatchOp"],
  "Operations": [{
    "op": "add",
    "path": "members",
    "value": [{ "value": "2819c223-7f76-453a-919d-413861904646" }]
  }]
}
```

### Example: /ServiceProviderConfig
```json
{
  "patch": { "supported": true },
  "bulk": { "supported": false },
  "filter": { "supported": true, "maxResults": 200 },
  "changePassword": { "supported": true },
  "sort": { "supported": true }
}
```

**Key points**:  
- Always check `/ServiceProviderConfig` before assuming vendor support.  
- Use `/Schemas` to confirm attribute definitions.  
- Use `/ResourceTypes` for resource discovery.  

---

## ğŸ¢ Real-world scenario
A company integrates Azure Entra ID with Zoom via SCIM.  

- Azure checks Zoomâ€™s `/ServiceProviderConfig` â†’ learns PATCH is supported, but Bulk is not.  
- Azure fetches `/Schemas` â†’ maps attributes correctly.  
- Azure provisions users into Zoom via `/Users`.  

**Impact:** Integration worked first try, with no guesswork about vendor capabilities.  

---

## âŒ Common pitfalls
- Ignoring `/ServiceProviderConfig` â†’ Leads to failed operations.  
- Assuming Bulk is supported everywhere.  
- Not fetching `/Schemas` â†’ Causes attribute mismatches.  
- Forgetting to page results from `/Users` or `/Groups`.  
- Confusing `/ResourceTypes` with `/Schemas`.  

---

## âš ï¸ Risks & issues

| Risk | Impact | Mitigation |
|------|--------|------------|
| Vendor hides unsupported features | Provisioning fails | Check `/ServiceProviderConfig` first |
| Missing schema fetch | Wrong attribute mapping | Always call `/Schemas` before mapping |
| Large result sets | Partial sync | Implement pagination and sorting |
| Assuming bulk ops | Failed requests | Verify Bulk support explicitly |

**Real-world:** A team assumed Bulk was supported by their SaaS app. Their provisioning failed until they discovered `/ServiceProviderConfig` explicitly listed Bulk as unsupported.  

---

## ğŸ“ Mini quiz
1. Which SCIM endpoint provides supported features like PATCH or Bulk?  
   a) `/Schemas`  
   b) `/Users`  
   c) `/Groups`  
   d) `/ServiceProviderConfig`  

2. Which endpoint lists attributes required for User objects?  
   a) `/Users`  
   b) `/Groups`  
   c) `/Schemas`  
   d) `/ResourceTypes`  

3. Scenario: A provisioning integration fails because PATCH isnâ€™t supported. Which endpoint should you check first?  
   a) `/Schemas`  
   b) `/ServiceProviderConfig`  
   c) `/Bulk`  
   d) `/Groups`  

---

## ğŸ”— Navigation
ğŸ‘‰ Back: [3.01 Protocol Overview](3.01-protocol-overview.md)  
ğŸ‘‰ Next: [3.03 HTTP Methods](3.03-http-methods.md)  

â¡ï¸ Next, weâ€™ll explore **HTTP Methods (3.03)** to understand how SCIM uses POST, PUT, PATCH, and DELETE for lifecycle operations.
