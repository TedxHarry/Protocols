# ğŸ† Section 1.05 | Foundations | **"Lifecycle Operations in SCIM"**

## ğŸ“Œ At a glance  
SCIM is designed to automate **lifecycle events** â€” provisioning, updating, and deprovisioning users and groups.  
This aligns with the **joiner, mover, leaver (JML)** model used in Identity and Access Management (IAM).  

---

## ğŸ“– What are SCIM lifecycle operations?  
Lifecycle operations describe the actions performed on identity objects (Users and Groups) throughout their existence.  
SCIM provides standardized ways to:  

- **Provision (Joiner)** â†’ Create a new user or group.  
- **Update (Mover)** â†’ Modify attributes (role, department, group membership).  
- **Deprovision (Leaver)** â†’ Disable or delete accounts when no longer needed.  

**ğŸ”„ Flow overview**
```text
HR Event â†’ IdP (SCIM client) â†’ SCIM API â†’ SP (SCIM server)
   Hire          POST /Users       â†’      new account created
   Transfer      PATCH /Users      â†’      attributes or groups updated
   Termination   DELETE /Users     â†’      account disabled or deleted
```

> **Note (worth keeping):** SCIM does not define *when* lifecycle operations should occur â€” that comes from HR or IAM policy. SCIM only standardizes *how* those changes are communicated to applications.  

---

## ğŸ”‘ Key characteristics  
- **Create (POST)** â†’ Adds new Users or Groups.  
- **Update (PUT/PATCH)** â†’ Modifies existing attributes or memberships.  
- **Delete (DELETE)** â†’ Removes or disables the object.  
- **Search (GET)** â†’ Retrieves objects for sync or validation.  
- **Stateless** â†’ Each lifecycle call is independent and must include all required data.  

---

## ğŸŒ Why it matters (and how it helps you later)  
- Defines how joiner, mover, and leaver processes are automated in SCIM.  
- Prevents orphaned accounts by ensuring **timely deprovisioning**.  
- Helps you connect IAM policies to SCIM operations during implementation.  
- Prepares you for schema-level details (Section 2) and protocol-level CRUD (Section 3).  

---

## ğŸ› ï¸ Where itâ€™s used (flows + impact)
- **Joiner** â†’ HR adds employee â†’ IdP **POST /Users** â†’ app account **created automatically**, no IT tickets required.
- **Mover** â†’ Role/department change â†’ IdP **PATCH /Users** or **PATCH /Groups** â†’ roles, entitlements, and memberships **updated instantly**.
- **Leaver** â†’ Exit event â†’ IdP **DELETE /Users** or `active=false` â†’ accounts **disabled across apps the same day**, no orphaned access.

ğŸ‘‰ Without SCIM: weeks of manual tickets and scripts. With SCIM: minutes, fully auditable.

- **Mover** â†’ Employee changes department â†’ Entra ID updates ServiceNow role.  
- **Leaver** â†’ Contractor ends engagement â†’ SailPoint disables GitHub account.  

---

## ğŸ”— How this links to other concepts (learning bridges)
- **Core Objects (1.03)** â†’ Lifecycle acts on Users & Groups. Without these, lifecycle has no targets.
- **CRUD Operations (3.04)** â†’ JML maps directly to POST, PATCH/PUT, and DELETE or soft disable.
- **Failures (4.03)** â†’ Shows what happens when lifecycle fails (e.g., orphaned accounts left active).

- **[CRUD Operations (3.04)](../3-protocol-operations/3.04-crud-operations.md)** â†’ Lifecycle operations map directly to POST, PATCH, DELETE.  
- **[Deprovisioning Risks (4.03)](../4-security-error-handling/4.03-common-failures.md)** â†’ Shows what happens when lifecycle ops fail.  

---

<details>
<summary><strong>âš™ï¸ Technical deep dive</strong> (click to expand)</summary>

**Create User (Joiner):**
```http
POST /scim/v2/Users
{
  "userName": "jdoe",
  "name": { "givenName": "John", "familyName": "Doe" },
  "active": true
}
```

**Update User (Mover):**
```http
PATCH /scim/v2/Users/2819c223-7f76-453a-919d-413861904646
{
  "Operations": [{
    "op": "Replace",
    "path": "department",
    "value": "Engineering"
  }]
}
```

**Deprovision User (Leaver):**
```http
DELETE /scim/v2/Users/2819c223-7f76-453a-919d-413861904646
```

**Key points:**  
- `active=false` can be used instead of DELETE for soft-deprovisioning.  
- `PATCH` is preferred for updates, but some SPs require `PUT`.  
</details>

---

<details>
<summary><strong>ğŸ¢ Real-world scenario</strong> (click to expand)</summary>
A consulting firm uses Workday â†’ Okta â†’ SaaS apps flow:  
- HR **hires** a new analyst in Workday â†’ Okta **creates** the user in Slack via SCIM.  
- Analyst **moves** to another project â†’ Okta **updates** group memberships in ServiceNow via SCIM.  
- Analyst **leaves** the company â†’ Okta **disables** accounts in Slack and ServiceNow via SCIM.  
</details>

---

<details>
<summary><strong>âŒ Common pitfalls</strong> (click to expand)</summary>

- Relying on DELETE instead of `active=false` â†’ accidental data loss.  
- SP not supporting PATCH â†’ forcing full PUT operations.  
- Delay between HR event and SCIM call â†’ compliance gaps.  
- Incomplete deprovisioning â†’ orphaned accounts remain active.  
</details>

---

<details>
<summary><strong>âš ï¸ Risks & issues</strong> (click to expand)</summary>

| Risk | Impact | Mitigation |
|------|--------|------------|
| Misaligned lifecycle mapping | Wrong account status | Validate HR â†’ IdP â†’ SP mappings |
| Incomplete deprovisioning | Orphaned access | Test disable vs delete in all apps |
| Lack of PATCH support | Inefficient updates | Use PUT fallback, document vendor limits |
</details>

---

<details>
<summary><strong>ğŸ“ Mini quiz</strong> (click to expand)</summary>

1) Which SCIM operation is most associated with a "mover" event?  
a) POST  
b) PATCH  
c) DELETE  
d) GET  

2) Whatâ€™s the safer option for leaver events in SCIM?  
a) DELETE the user immediately  
b) Set `active=false`  
c) Remove all attributes  
d) Change userName  

3) True or False: SCIM defines both the timing and method of lifecycle operations.  
</details>

---

## ğŸ”— Navigation  
ğŸ‘‰ **Back:** [1.04 SCIM vs LDAP vs Proprietary APIs](./1.04-scim-vs-ldap.md)  
ğŸ‘‰ **Next:** [1.06 Where SCIM fits in IAM](./1.06-scim-in-iam.md)  

## âš ï¸ Risks & issues
| Risk | Impact | Mitigation |
|------|--------|------------|
| Mis-mapped attributes | Inconsistent accounts | Validate schema mapping in pilots |
| Weak deprovisioning | Orphaned accounts remain active | Test disable/delete paths in each app |
| Partial vendor support | Missing PATCH or filters | Check `/ServiceProviderConfig`, plan workarounds |
| Protocol confusion | Wrong tool for the job | Train teams on SCIM vs SSO protocols |

Real-world: A company kept 200+ Slack users active months after exit because SCIM wasnâ€™t connected. Audit flagged this as high-risk.
