# 🏆 Section 1.02 | Foundations | **SCIM Architecture**

## 📌 At a glance
SCIM uses a **client–server architecture**. The **IdP (client)** initiates provisioning; the **SaaS app (server)** exposes SCIM endpoints to process requests.

## 📖 What is SCIM architecture?
- **Client (IdP/IAM)**: Okta, Entra ID, SailPoint — initiates POST/PUT/PATCH/DELETE
- **Server (SaaS app)**: Slack, Zoom, ServiceNow, GitHub — exposes `/Users`, `/Groups`
- **Endpoints**: `/Users`, `/Groups`, `/Schemas`, `/ServiceProviderConfig`

**Flow**
```
Identity Provider (Client) ── SCIM API ──> Service Provider (Server)
   create/update/delete user                account created/updated/removed
```

> **Note (worth keeping):** In SCIM, the **IdP is always the client** and the **SP is always the server**. Mixing roles causes troubleshooting dead‑ends.

## 🔑 Key characteristics
- **Client‑initiated** lifecycle calls
- **Predictable endpoints** (`/Users`, `/Groups`, etc.)
- **REST/JSON** requests and responses
- **Stateless** per HTTP; each call stands alone

## 🌍 Why it matters (and how it helps you later)
- Lets you pinpoint responsibility during failures (client vs server)
- Forms the mental model for schemas (what flows) and operations (how)
- Readies you for interview questions like “Who initiates SCIM requests?”

## 🛠️ Where it’s used (flows + impact)
- **Okta → Slack**: Okta **POST /Users**; Slack **creates** accounts and returns IDs
- **Entra → ServiceNow**: Entra **PATCH /Users**; roles/licensing **updated** automatically
- **SailPoint → Workday**: lifecycle **mapped** from IGA into HR or downstream SaaS

## 🔗 How this links to other concepts (learning bridges)
- **What is SCIM? (1.01)** → the “why”; architecture is the “how it’s wired”
- **Endpoints (3.02)** → expands on `/Users`, `/Groups`, `/ServiceProviderConfig`
- **CRUD (3.04)** → actual HTTP verbs this architecture enables

## ⚙️ Technical deep dive
**Key SCIM endpoints**
| Endpoint | Purpose |
|---|---|
| `/Users` | Manage user resources (CRUD, search) |
| `/Groups` | Manage group objects and memberships |
| `/Schemas` | Retrieve object definitions |
| `/ServiceProviderConfig` | Discover supported features |

**Example: Client creates a user**
```http
POST /scim/v2/Users
{
  "userName": "jdoe",
  "name": { "givenName": "John", "familyName": "Doe" },
  "emails": [{ "value": "jdoe@example.com", "primary": true }]
}
```
**Server response**
```json
{ "id": "a123", "userName": "jdoe", "active": true }
```

## 🏢 Real‑world scenario
Okta (client) **sends POST** to Slack `/Users`. Slack (server) **creates** the account and returns `id`. On exit, Okta **DELETEs** or sets `active=false`; Slack **disables** access immediately.

## ❌ Common pitfalls
- Thinking SP can initiate provisioning
- Assuming all endpoints are supported (some lack `/Groups`)
- Skipping `/ServiceProviderConfig` checks for capabilities

## ⚠️ Risks & issues
| Risk | Impact | Mitigation |
|---|---|---|
| Role confusion | Misrouted troubleshooting | Confirm client/server early |
| Partial endpoints | Missing features | Query `/ServiceProviderConfig` |
| Network/API errors | Incomplete provisioning | Retries, monitoring, alerts |

## 📝 Mini quiz
1) In SCIM, who is the client? a) Slack b) **Okta** c) GitHub d) Zoom  
2) Which endpoint lists capabilities? a) `/Users` b) `/Groups` c) **/ServiceProviderConfig** d) `/Schemas`  
3) True/False: The server initiates lifecycle events. **False**

## 🔗 Navigation
👉 **Back:** [1.01 What is SCIM?](./1.01-what-is-scim.md) · 👉 **Next:** [1.03 Core Objects](./1.03-core-objects.md)
