# 🏆 Section 1.03 | Foundations | “Core Objects”

---

## 📌 At a glance
The **core objects** in SCIM are **Users** and **Groups**.  
These two resource types define how identities are represented and related across applications.  
Every SCIM request revolves around creating, updating, or managing these core objects.  

---

## 📖 What are Core Objects?
SCIM defines a **resource model** where identity data is structured into standard objects.  
The two mandatory resource types are:  
- **User** → Represents an individual identity.  
- **Group** → Represents a collection of users for access and role assignment.  

> **Notes**
- Defined in **RFC 7643 (SCIM Schema)**.  
- Objects are addressed via REST endpoints `/Users` and `/Groups`.  
- Both objects are extensible with enterprise and custom attributes.  

---

## 🔑 Key characteristics
- **User**: Contains attributes like `userName`, `name`, `emails`, `phoneNumbers`, `groups`.  
- **Group**: Contains attributes like `displayName`, `members`.  
- **Unique identifier**: Every object has a required `id` (server-managed).  
- **ExternalId**: Client-managed identifier, useful for mapping with HR or source systems.  
- **Schemas**: Every resource must include a `schemas` array to indicate applicable schema URNs.  
- **Meta object**: Tracks `created`, `lastModified`, and `version` of resources.  
- **Relationships**: Users can belong to multiple groups; groups can have multiple members.  

---

## 🌍 Why it matters (and how it helps you later)
- **IAM perspective**: Core objects are the foundation of provisioning — everything else in SCIM builds on these.  
- **Compliance**: Auditors often ask for **user-to-group mappings**, making groups just as critical as users.  
- **Learning payoff**: Understanding these objects prepares you for advanced topics like **attribute mapping, filtering, bulk operations, and group-based access control**.  

---

## 🛠️ Where it’s used (flows + impact)

### User lifecycle
```
HR System → IdP → SCIM /Users endpoint
```
- Joiner → `POST /Users` → New user created.  
- Mover → `PATCH /Users` → Attributes updated.  
- Leaver → `PATCH active:false` → User disabled.  

### Group lifecycle
```
IdP → SCIM /Groups endpoint → App access
```
- Group created → Assigns access bundle to users.  
- User added to group → Inherits access automatically.  
- User removed from group → Access revoked.  

Impact: Without SCIM, IT teams manually sync user lists and group memberships → **slow, error-prone, high risk**.  
With SCIM, memberships are updated in **real-time**.  

---

## 🔗 How this links to other concepts
- [1.02 SCIM Architecture](1.02-scim-architecture.md) → Explained **roles and endpoints**; now you see what lives inside those endpoints.  
- [2.02 User Schema](../2-core-schema/2.02-user-schema.md) → Provides a deep dive into **user attributes and schema definitions**.  
- [2.03 Group Schema](../2-core-schema/2.03-group-schema.md) → Details the structure and rules for SCIM groups.  

---

## ⚙️ Technical deep dive

### Example: User object (minimal)
```json
{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"],
  "id": "2819c223-7f76-453a-919d-413861904646",
  "userName": "bjensen",
  "name": {
    "givenName": "Barbara",
    "familyName": "Jensen"
  },
  "emails": [
    { "value": "bjensen@example.com", "primary": true }
  ]
}
```
**Key points**:  
- `schemas` is mandatory.  
- `id` assigned by SCIM server.  
- `externalId` (not shown here) is optional but useful for IdPs.  

### Example: Group object (minimal)
```json
{
  "schemas": ["urn:ietf:params:scim:schemas:core:2.0:Group"],
  "id": "c3d1d3f2",
  "displayName": "Engineering",
  "members": [
    { "value": "2819c223-7f76-453a-919d-413861904646", "display": "bjensen" }
  ]
}
```
**Key points**:  
- Groups can contain multiple members.  
- Memberships are references to `User` object IDs.  
- Removing a member from a group revokes access instantly.  

---

## 🏢 Real-world scenario
A company manages 5,000 employees with Okta as IdP and ServiceNow as SP.  

- Without SCIM: IT manually updated **users and groups** in ServiceNow weekly. Errors left privileged groups (like “IT Admins”) with wrong members.  
- With SCIM: IdP manages `/Users` and `/Groups`. Group-based assignments auto-provision access to ServiceNow roles.  

**Impact:** Access mismatches dropped by 90%, onboarding time reduced from 2 days to < 1 hour.  

---

## ❌ Common pitfalls
- Forgetting to include `schemas` array → request rejected.  
- Confusing `id` (server-generated) with `externalId` (client-generated).  
- Not handling case sensitivity in `userName`.  
- Assuming groups are optional → many apps require groups for role-based provisioning.  
- Ignoring `meta` object → makes troubleshooting harder.  

---

## ⚠️ Risks & issues

| Risk | Impact | Mitigation |
|------|--------|------------|
| Duplicate externalIds | Sync errors with HR system | Ensure uniqueness in externalId mappings |
| Large groups | Performance issues when resolving memberships | Use paging for large group membership retrieval |
| Incorrect group assignments | Over-provisioned access | Automate testing of group mappings |
| Schema drift | Inconsistent attributes across apps | Validate schema alignment regularly |

**Real-world:** A misconfigured SCIM group mapping provisioned all contractors into “Full Employees” group, granting unnecessary access.  

---

## 📝 Mini quiz
1. Which two objects are considered **core resources** in SCIM?  
   a) Users and Roles  
   b) Users and Groups  
   c) Groups and Permissions  
   d) Roles and Attributes  

2. Which identifier is **server-assigned** and mandatory?  
   a) `externalId`  
   b) `id`  
   c) `schemas`  
   d) `meta.version`  

3. Scenario: You see duplicate records for the same employee because HR changed their employee ID. Which attribute likely wasn’t managed correctly?  
   a) `id`  
   b) `externalId`  
   c) `userName`  
   d) `displayName`  

---

## 🔗 Navigation
👉 Back: [1.02 SCIM Architecture](1.02-scim-architecture.md)  
👉 Next: [1.04 SCIM vs LDAP](1.04-scim-vs-ldap.md)
