# 🏆 Section 1.05 | Foundations | **"Lifecycle Operations in SCIM"**

## 📌 At a glance  
SCIM is designed to automate **lifecycle events** — provisioning, updating, and deprovisioning users and groups.  
This aligns with the **joiner, mover, leaver (JML)** model used in Identity and Access Management (IAM).  

---

## 📖 What are SCIM lifecycle operations?  
Lifecycle operations describe the actions performed on identity objects (Users and Groups) throughout their existence.  
SCIM provides standardized ways to:  

- **Provision (Joiner)** → Create a new user or group.  
- **Update (Mover)** → Modify attributes (role, department, group membership).  
- **Deprovision (Leaver)** → Disable or delete accounts when no longer needed.  

**🔄 Flow overview**
```text
HR Event → IdP (SCIM client) → SCIM API → SP (SCIM server)
   Hire          POST /Users       →      new account created
   Transfer      PATCH /Users      →      attributes or groups updated
   Termination   DELETE /Users     →      account disabled or deleted
```

> **Note (worth keeping):** SCIM does not define *when* lifecycle operations should occur — that comes from HR or IAM policy. SCIM only standardizes *how* those changes are communicated to applications.  

---

## 🔑 Key characteristics  
- **Create (POST)** → Adds new Users or Groups.  
- **Update (PUT/PATCH)** → Modifies existing attributes or memberships.  
- **Delete (DELETE)** → Removes or disables the object.  
- **Search (GET)** → Retrieves objects for sync or validation.  
- **Stateless** → Each lifecycle call is independent and must include all required data.  

---

## 🌍 Why it matters (and how it helps you later)  
- Defines how joiner, mover, and leaver processes are automated in SCIM.  
- Prevents orphaned accounts by ensuring **timely deprovisioning**.  
- Helps you connect IAM policies to SCIM operations during implementation.  
- Prepares you for schema-level details (Section 2) and protocol-level CRUD (Section 3).  

---

## 🛠️ Where it’s used  
- **Joiner** → HR adds an employee in Workday → Okta provisions a Zoom account.  
- **Mover** → Employee changes department → Entra ID updates ServiceNow role.  
- **Leaver** → Contractor ends engagement → SailPoint disables GitHub account.  

---

## 🔗 How this links to other concepts  
- **[Core Objects (1.03)](./1.03-core-objects.md)** → Users and Groups are what lifecycle operations act on.  
- **[CRUD Operations (3.04)](../3-protocol-operations/3.04-crud-operations.md)** → Lifecycle operations map directly to POST, PATCH, DELETE.  
- **[Deprovisioning Risks (4.03)](../4-security-error-handling/4.03-common-failures.md)** → Shows what happens when lifecycle ops fail.  

---

<details>
<summary><strong>⚙️ Technical deep dive</strong> (click to expand)</summary>

**Create User (Joiner):**
```http
POST /scim/v2/Users
{
  "userName": "jdoe",
  "name": { "givenName": "John", "familyName": "Doe" },
  "active": true
}
```

**Update User (Mover):**
```http
PATCH /scim/v2/Users/2819c223-7f76-453a-919d-413861904646
{
  "Operations": [{
    "op": "Replace",
    "path": "department",
    "value": "Engineering"
  }]
}
```

**Deprovision User (Leaver):**
```http
DELETE /scim/v2/Users/2819c223-7f76-453a-919d-413861904646
```

**Key points:**  
- `active=false` can be used instead of DELETE for soft-deprovisioning.  
- `PATCH` is preferred for updates, but some SPs require `PUT`.  
</details>

---

<details>
<summary><strong>🏢 Real-world scenario</strong> (click to expand)</summary>
A consulting firm uses Workday → Okta → SaaS apps flow:  
- HR **hires** a new analyst in Workday → Okta **creates** the user in Slack via SCIM.  
- Analyst **moves** to another project → Okta **updates** group memberships in ServiceNow via SCIM.  
- Analyst **leaves** the company → Okta **disables** accounts in Slack and ServiceNow via SCIM.  
</details>

---

<details>
<summary><strong>❌ Common pitfalls</strong> (click to expand)</summary>

- Relying on DELETE instead of `active=false` → accidental data loss.  
- SP not supporting PATCH → forcing full PUT operations.  
- Delay between HR event and SCIM call → compliance gaps.  
- Incomplete deprovisioning → orphaned accounts remain active.  
</details>

---

<details>
<summary><strong>⚠️ Risks & issues</strong> (click to expand)</summary>

| Risk | Impact | Mitigation |
|------|--------|------------|
| Misaligned lifecycle mapping | Wrong account status | Validate HR → IdP → SP mappings |
| Incomplete deprovisioning | Orphaned access | Test disable vs delete in all apps |
| Lack of PATCH support | Inefficient updates | Use PUT fallback, document vendor limits |
</details>

---

<details>
<summary><strong>📝 Mini quiz</strong> (click to expand)</summary>

1) Which SCIM operation is most associated with a "mover" event?  
a) POST  
b) PATCH  
c) DELETE  
d) GET  

2) What’s the safer option for leaver events in SCIM?  
a) DELETE the user immediately  
b) Set `active=false`  
c) Remove all attributes  
d) Change userName  

3) True or False: SCIM defines both the timing and method of lifecycle operations.  
</details>

---

## 🔗 Navigation  
👉 **Back:** [1.04 SCIM vs LDAP vs Proprietary APIs](./1.04-scim-vs-ldap.md)  
👉 **Next:** [1.06 Where SCIM fits in IAM](./1.06-scim-in-iam.md)  
