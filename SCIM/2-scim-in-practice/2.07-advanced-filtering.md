![Cover](./covers/2.07-advanced-filtering.png)
# ğŸ† Section 2.07 | SCIM in Practice | â€œAdvanced Filtering & Query Parametersâ€

Filtering is one of SCIMâ€™s most powerful features.  
You learned the basics in Section 1.06 â€” simple comparisons like `userName eq "jane.doe"`.  

Now itâ€™s time to go deeper. In real-world provisioning, youâ€™ll need to filter by **multiple attributes**, apply **logical operators**, query inside **multi-valued attributes**, and combine filters with **pagination**.  

---

## ğŸ“– Why Advanced Filtering Matters  

- **Efficiency** â†’ Fetch only the identities you need instead of pulling everything.  
- **Precision** â†’ Narrow down queries to specific users, departments, or roles.  
- **Scalability** â†’ Essential when dealing with thousands of users.  

Without filtering, integrations become heavy, slow, and error-prone.  

---

## 1ï¸âƒ£ Supported Operators (Recap + Advanced)  

- `eq` â†’ equal  
- `ne` â†’ not equal  
- `co` â†’ contains  
- `sw` â†’ starts with  
- `ew` â†’ ends with  
- `pr` â†’ present (attribute exists)  
- `gt`, `lt`, `ge`, `le` â†’ numeric/date comparisons  

**Example: All users created after Jan 1, 2024**  

```http
GET /Users?filter=meta.created gt "2024-01-01T00:00:00Z"
```

---

## 2ï¸âƒ£ Logical Operators (`and`, `or`)  

Combine multiple conditions.  

**Example: Active engineers**  

```http
GET /Users?filter=active eq true and department eq "Engineering"
```

**Example: Users in Finance OR HR**  

```http
GET /Users?filter=department eq "Finance" or department eq "HR"
```

---

## 3ï¸âƒ£ Filtering Multi-Valued Attributes (Path Filters)  

You can filter inside arrays like `emails` or `phoneNumbers`.  

**Example: Work emails ending with @example.com**  

```http
GET /Users?filter=emails[type eq "work" and value co "@example.com"]
```

Here:  
- `emails` is multi-valued.  
- The filter applies only to `type=work`.  

---

## 4ï¸âƒ£ Filtering Groups by Membership  

Find all users in a specific group.  

```http
GET /Users?filter=groups.value eq "a1b2c3d4"
```

This returns all users who belong to the group with `id = a1b2c3d4`.  

---

## 5ï¸âƒ£ Combining Filters with Pagination  

For large datasets, combine filtering with pagination.  

**Example: Get first 100 active users in Engineering**  

```http
GET /Users?filter=active eq true and department eq "Engineering"&startIndex=1&count=100
```

---

## âš ï¸ Common Pitfalls (and Impact)  

- âŒ **Assuming all vendors support complex filters** â†’ some only allow basic `eq`.  
- âŒ **Case sensitivity issues** â†’ filters may behave differently across platforms.  
- âŒ **Unreadable errors** â†’ many SPs just return `400 Bad Request` without details.  
- âŒ **Nested path filters not supported** â†’ advanced queries may silently fail.  
- âŒ **Over-fetching** â†’ not combining pagination leads to performance issues.  

---

## âœ… Best Practices  

- Always check `/ServiceProviderConfig` for supported filters.  
- Keep filters as simple as possible â€” test them before deploying.  
- Use pagination when expecting large result sets.  
- Donâ€™t rely on full RFC compliance â€” build fallbacks if a vendor ignores complex queries.  
- Log filter queries and responses to help troubleshoot issues.  

---

## ğŸ¢ Real-World Examples  

- **Find inactive contractors**  

```http
GET /Users?filter=active eq false and userType eq "Contractor"
```

- **Find managers in Engineering**  

```http
GET /Users?filter=title co "Manager" and department eq "Engineering"
```

- **Find users missing work email**  

```http
GET /Users?filter=not emails[type eq "work" and value pr]
```

---

## ğŸ“ Self-Check  

1ï¸âƒ£ How would you query all users in HR created after 2024?  
2ï¸âƒ£ What operator checks if an attribute exists?  
3ï¸âƒ£ Why should you combine pagination with filtering?  
4ï¸âƒ£ What happens if a Service Provider doesnâ€™t support complex filters?  

---

## ğŸ¯ Final Takeaway  

Filtering is more than just `eq`.  
- Use **logical operators** (`and`, `or`) for precision.  
- Apply **path filters** to search inside multi-valued attributes.  
- Always combine with **pagination** for performance.  
- Expect partial support â€” not every vendor implements the full RFC.  

ğŸ’¡ Mastering advanced filters makes your SCIM integrations efficient, scalable, and production-ready.  

---

## ğŸ”— Navigation  

ğŸ‘‰ Back: [2.06 HTTP Methods & CRUD Behavior](2.06-http-methods-crud.md)  
ğŸ‘‰ Next: [2.08 Pagination & Sorting](2.08-pagination-sorting.md)  
