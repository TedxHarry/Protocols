![Cover](./covers/2.02-user-schema.png)
# üèÜ Section 2.02 | SCIM in Practice | ‚ÄúUser Schema Details‚Äù

The **User schema** is the heart of SCIM.  
Every real-world SCIM integration starts with Users because provisioning always begins with creating or updating identity records.  

If you understand this schema well, most of SCIM will feel like logical variations.  

---

## üìñ What is the SCIM User Resource?  

A **User** represents a person in your organization.  

- It defines **who the person is** (login name, full name, contact info).  
- It shows **status** (active or not).  
- It can include **job context** (title, department, manager).  
- It supports **extensions** for extra attributes your business needs.  

‚ö†Ô∏è Vendors may not implement every attribute, but the overall structure follows **RFC 7643**.

---

## üß© Categories of User Attributes  

User attributes fall into four categories:  

1. **Core Attributes** ‚Üí required for every User (`schemas`, `id`, `userName`, `meta`).  
2. **Contact and Identity Attributes** ‚Üí how to reach the user (`emails`, `phoneNumbers`, `addresses`, `photos`).  
3. **Organizational Context** ‚Üí workplace details (`title`, `roles`, `groups`, Enterprise extension).  
4. **Credentials** ‚Üí sensitive fields like `password` (rarely supported).  

---

## 1Ô∏è‚É£ Core Attributes (Always Required or Essential)  

### `schemas` (Mandatory)  
- Tells the Service Provider what kind of object this is.  
- Without it, the request **will fail immediately**.  

```json
"schemas": ["urn:ietf:params:scim:schemas:core:2.0:User"]
```

üëâ If you also use the Enterprise User extension, add its URN here.  
(*URN = Uniform Resource Name, a unique string that identifies a schema.*)

---

### `id` (Mandatory, Server-assigned)  
- Unique identifier created by the Service Provider.  
- Stable for the life of the User.  
- Always **read-only**.  
- Used in endpoints like `/Users/{id}`.  

---

### `externalId` (Optional, Client-assigned)  
- A way for **your system** to track this User across platforms.  
- Commonly set to the HR system‚Äôs employee ID.  
- Useful in migrations or reconciliation.  

‚ö†Ô∏è Never confuse this with `id`.  
- `id` ‚Üí assigned by the Service Provider.  
- `externalId` ‚Üí assigned by the client (HR, IdP, etc.).  

---

### `userName` (Mandatory)  
- The **login identifier** for the user.  
- Must be unique within the tenant.  
- Always required when creating a User.  

üëâ Some apps expect an **email** here, others a **username**. Always check the Service Provider‚Äôs documentation.  

Example:  

```json
"userName": "jane.doe"
```

---

### `name` (Optional but Common)  

```json
"name": {
  "formatted": "Jane Doe",
  "familyName": "Doe",
  "givenName": "Jane",
  "middleName": "A",
  "honorificPrefix": "Dr.",
  "honorificSuffix": "Jr."
}
```

---

### `displayName` (Optional)  
- A friendly label shown in UIs.  
- Often matches `name.formatted` but not always.  

---

### `active` (Boolean)  
- Indicates whether the account is enabled.  
- Use `false` for offboarding instead of deleting.  
- Preserves history for audits.  

---

### `meta` (Mandatory, Server-assigned)  

```json
"meta": {
  "resourceType": "User",
  "created": "2025-01-15T04:56:22Z",
  "lastModified": "2025-02-01T11:42:55Z",
  "version": "W/\"123456\"",
  "location": "https://example.com/scim/v2/Users/2819c223"
}
```

- `created` / `lastModified` ‚Üí timestamps for auditing and sync.  
- `version` ‚Üí change counter to detect updates.  
- `location` ‚Üí API endpoint for this resource.  

---

## 2Ô∏è‚É£ Contact and Identity Attributes  

### `emails`  
- Commonly required by apps.  
- Always mark one as **primary**.  

```json
"emails": [
  { "value": "jane.doe@company.com", "type": "work", "primary": true },
  { "value": "jane.personal@example.com", "type": "home" }
]
```

---

### `phoneNumbers`  

```json
"phoneNumbers": [
  { "value": "+1-312-555-0177", "type": "work", "primary": true },
  { "value": "+1-773-555-0199", "type": "mobile" }
]
```

---

### `addresses`  

```json
"addresses": [
  {
    "type": "work",
    "streetAddress": "123 Main St",
    "locality": "Chicago",
    "region": "IL",
    "postalCode": "60601",
    "country": "US",
    "primary": true
  }
]
```

---

### `photos`  

```json
"photos": [
  { "value": "https://cdn.example.com/photos/jane.jpg", "type": "photo" },
  { "value": "https://cdn.example.com/thumbs/jane.jpg", "type": "thumbnail" }
]
```

---

### `preferredLanguage`, `locale`, `timezone`  

```json
"preferredLanguage": "en",
"locale": "en_US",
"timezone": "America/Chicago"
```

---

## 3Ô∏è‚É£ Organizational Context and Roles  

### `title`, `userType`  

```json
"title": "Senior Engineer",
"userType": "Employee"
```

---

### `department`, `organization`  
- Often supported via the **Enterprise User extension**.  
- Check `/Schemas` or vendor docs.  

---

### `roles`  

```json
"roles": [
  { "value": "ProjectAdmin", "type": "application", "primary": true },
  { "value": "BetaTester", "type": "application" }
]
```

---

### `groups` (Read-only)  
- Lists groups the user belongs to.  
- Many providers populate this automatically.  
- You **cannot** update membership here ‚Äî you must update the Group object.  

```json
"groups": [
  { "value": "e9e30dba-f08f-4109-8486-d5c6a331660a", "display": "Engineering" }
]
```

---

## 4Ô∏è‚É£ Enterprise User Extension  

URN: `urn:ietf:params:scim:schemas:extension:enterprise:2.0:User`  

```json
"schemas": [
  "urn:ietf:params:scim:schemas:core:2.0:User",
  "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User"
],
"urn:ietf:params:scim:schemas:extension:enterprise:2.0:User": {
  "employeeNumber": "12345",
  "costCenter": "RND-ENG-001",
  "organization": "ExampleCorp",
  "division": "Engineering",
  "department": "Platform",
  "manager": { "value": "2819c223-7f76-453a-919d-413861904646" }
}
```

Notes:  
- Always include the URN in `schemas` or attributes will be ignored.  
- This extension is widely used in HR ‚Üí IT integrations.  
- Only map fields if data quality upstream is reliable.  

---

## 5Ô∏è‚É£ Credentials  

### `password`  
- SCIM can carry passwords if supported.  
- Check `/ServiceProviderConfig` for `changePassword.supported`.  
- Prefer IdP-managed credentials (SSO).  
- Never log payloads containing `password`.  
- If used, ensure TLS and encryption.  

---

## üß™ Complete Example User Payload  

```json
{
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User",
    "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User"
  ],
  "userName": "jane.doe",
  "name": { "givenName": "Jane", "familyName": "Doe", "formatted": "Jane A Doe" },
  "displayName": "Jane Doe",
  "active": true,
  "emails": [
    { "value": "jane.doe@company.com", "type": "work", "primary": true }
  ],
  "phoneNumbers": [
    { "value": "+1-312-555-0177", "type": "work", "primary": true }
  ],
  "addresses": [
    { "type": "work", "streetAddress": "123 Main St", "locality": "Chicago", "region": "IL", "postalCode": "60601", "country": "US", "primary": true }
  ],
  "photos": [
    { "value": "https://cdn.example.com/photos/jane.jpg", "type": "photo" }
  ],
  "preferredLanguage": "en",
  "locale": "en_US",
  "timezone": "America/Chicago",
  "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User": {
    "employeeNumber": "12345",
    "department": "Platform",
    "manager": { "value": "2819c223-7f76-453a-919d-413861904646" }
  },
  "externalId": "WD-12345"
}
```

---

## ‚ö†Ô∏è Common Pitfalls and Their Impact  

- Missing `schemas` ‚Üí request rejected.  
- Using `DELETE` for offboarding ‚Üí audit history lost, orphaned records.  
- Assuming `userName` must be email ‚Üí leads to failed logins.  
- Forgetting `primary:true` in multi-valued attributes ‚Üí UI may not know which value to use.  
- Treating `id` as writable ‚Üí Service Provider will reject it.  
- Sending `password` when unsupported ‚Üí request fails.  
- Expecting `groups` to be writable in User ‚Üí update membership in Group object.  

---

## üìù Self-Check  

1Ô∏è‚É£ What are the mandatory attributes for a SCIM User resource?  
2Ô∏è‚É£ Why must `userName` always be unique and present?  
3Ô∏è‚É£ Why should you set `active:false` instead of deleting a user?  
4Ô∏è‚É£ What role does the Enterprise User extension play?  
5Ô∏è‚É£ How do you manage group membership correctly in SCIM?  

---

## üéØ Final Takeaway  

The SCIM User schema is **the foundation of identity provisioning**.  

Focus on these for success:  
- `userName` ‚Üí required, unique login identifier.  
- `emails` ‚Üí mark one as `primary:true`.  
- `active` ‚Üí drives lifecycle state.  
- `externalId` ‚Üí maps to your external system.  
- Enterprise User extension ‚Üí adds critical workplace context.  

üí° Once you master the User schema, the rest of SCIM becomes much easier.  

---

## üîó Navigation  

üëâ Back: [2.01 Core Schema Overview](2.01-core-schema-overview.md)  
üëâ Next: [2.03 Group Schema Details](2.03-group-schema.md)  
