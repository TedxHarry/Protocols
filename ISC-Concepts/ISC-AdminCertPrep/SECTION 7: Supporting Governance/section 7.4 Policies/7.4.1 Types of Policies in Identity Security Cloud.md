## 7.4: Policies

### 7.4.1: Types of Policies in Identity Security Cloud

### Overview
Policies in SailPoint ISC enforce security controls, prevent risky access combinations, and ensure compliance. Understanding the different policy types, their purposes, and when to use each is critical for governance and the certification exam.

**What you'll learn:**
- Four main policy types in ISC
- Separation of Duties (SoD) policies
- Access policies
- Account policies  
- Password policies
- Policy enforcement (preventive vs detective)

---

### Policy Types Overview

**Four core policy categories:**

| Policy Type | Purpose | Enforcement | Primary Use |
|-------------|---------|-------------|-------------|
| **SoD (Separation of Duties)** | Prevent conflicting access | Preventive & Detective | Compliance, fraud prevention |
| **Access Policies** | Control who gets what access | Preventive | Authorization, risk-based access |
| **Account Policies** | Manage account lifecycle | Detective | Orphaned accounts, inactive users |
| **Password Policies** | Enforce password standards | Preventive | Security, credential management |

---

### Type 1: Separation of Duties (SoD) Policies

**Purpose:** Prevent users from having conflicting combinations of access that enable fraud or errors.

#### Core Concept
```
The Problem:
Single user has incompatible permissions:
- Create vendor AND approve payments
- Submit expense AND approve expense
- Create user AND grant admin rights
- Request access AND approve requests

The Risk:
- Fraud (self-approval, fake transactions)
- Errors (no second check)
- Compliance violations (SOX, audit findings)

The Solution:
SoD policy detects and prevents these combinations
```

#### SoD Policy Components

**Conflicting entitlements:**
```
Policy: Finance SoD - Vendor Management

Left Side (Entitlement Set 1):
- SAP: Create Vendor (T-code FK01)
- Oracle: Vendor Creation Role
- Any entitlement allowing vendor creation

Right Side (Entitlement Set 2):
- SAP: Process Payment (T-code F-53)
- Oracle: Payment Approval Role  
- Any entitlement allowing payment approval

Conflict: Having BOTH sides = SoD violation
Risk Level: HIGH
Compliance: SOX requirement
```

**Policy configuration:**
```
Name: Finance SoD - Vendor & Payment
Description: Prevent vendor creation + payment approval
State: Active

Entitlement Set 1 (Left):
- Source: SAP
- Entitlement: Create Vendor (FK01)

Operator: AND (user must have BOTH to violate)

Entitlement Set 2 (Right):
- Source: SAP  
- Entitlement: Process Payment (F-53)

Violation occurs when: User has both entitlements
```

#### Enforcement Modes

**Preventive (request-time):**
```
User requests access → SoD check runs

Scenario:
User: john.accountant
Current access: Create Vendor (FK01)
Requests: Process Payment (F-53)

SoD Check:
Policy: Finance SoD - Vendor & Payment
Result: VIOLATION DETECTED

Action options:
1. Block request (hard enforcement)
2. Allow with approval (soft enforcement)
3. Allow with justification (exception)

Configuration example (hard enforcement):
Request blocked with message:
"This access violates SoD policy 'Finance SoD - 
Vendor & Payment'. You cannot have both vendor
creation and payment approval rights."
```

**Detective (certification/audit):**
```
Already has violation → Detected in certification

Scenario:
User: jane.manager
Access obtained through role assignments:
- Finance Manager role (includes Create Vendor)
- Payment Approver role (includes Process Payment)

Detection:
Certification campaign runs
SoD check identifies existing violation
Flagged to reviewer

Reviewer options:
- Revoke one side of violation
- Accept risk with justification
- Escalate for exception approval

Risk score impact:
User risk score increased from 45 → 78
Violation contributes to high-risk status
```

#### Common SoD Patterns

**Pattern 1: Create + Approve**
```
Examples:
- Create purchase order + Approve purchase order
- Create expense report + Approve expense report
- Create user account + Grant admin rights
- Submit time + Approve time

Regulatory driver: SOX, internal controls
Severity: HIGH
```

**Pattern 2: Request + Approve (same process)**
```
Examples:
- Request access + Approve access requests
- Submit change + Approve change
- Initiate wire transfer + Approve wire transfer

Risk: Self-approval
Severity: HIGH
```

**Pattern 3: Modify Data + Audit Data**
```
Examples:
- Edit financial records + Audit financial records
- Modify logs + Review logs
- Change security settings + Security audit

Risk: Concealment of changes
Severity: MEDIUM-HIGH
```

---

### Type 2: Access Policies

**Purpose:** Control who can request or be granted specific access based on criteria.

#### Access Policy Types

**Risk-based policies:**
```
Policy: High-Risk Role Access Control

Condition:
IF role.riskScore > 75
THEN require additional approval

Example:
Role: Domain Admin (risk score: 85)
Standard approval: Manager
Policy adds: Security team approval

Workflow:
1. User requests Domain Admin
2. Policy triggers (risk > 75)
3. Requires: Manager + Security team
4. Sequential approval enforced
```

**Attribute-based policies:**
```
Policy: Contractor Access Restrictions

Condition:
IF identity.employeeType = "Contractor"
THEN deny access to roles tagged "employees-only"

Example:
User: john.contractor (employeeType = Contractor)
Requests: HR System Access (tagged employees-only)
Result: Request denied by policy

Message:
"Contractors cannot access HR System. This access
is restricted to employees only per company policy."
```

**Time-based policies:**
```
Policy: Temporary Access Auto-Revocation

Condition:
IF access.grantDate + 90 days < current date
AND access.type = "temporary"
THEN revoke access automatically

Example:
Access granted: Jan 1, 2024 (temporary project access)
Policy check: April 1, 2024 (90 days elapsed)
Action: Automatic revocation triggered
Notification: User notified of removal
```

---

### Type 3: Account Policies

**Purpose:** Detect and remediate orphaned, inactive, or non-compliant accounts.

#### Account Policy Patterns

**Inactive account detection:**
```
Policy: Disable Inactive Accounts

Condition:
IF account.lastLogin > 90 days ago
AND account.status = "active"
THEN flag for review or auto-disable

Detection logic:
Query: account.lastLogin < (currentDate - 90)
Result: 234 accounts flagged

Actions:
Option 1: Auto-disable (aggressive)
Option 2: Notify manager for review (conservative)
Option 3: Certify during next campaign (detective)

Example:
Account: bob.employee (AD)
Last login: Nov 1, 2023
Current date: Feb 15, 2024 (105 days)
Policy action: Account disabled
Notification: Manager notified for verification
```

**Orphaned account detection:**
```
Policy: Detect Uncorrelated Accounts

Condition:
IF account exists in source
AND account NOT correlated to any identity
THEN flag as orphaned

Detection:
Source: Active Directory
Total accounts: 5,234
Correlated: 5,107
Orphaned: 127

Review workflow:
1. Identify orphaned accounts
2. Determine if service account (document)
3. Determine if correlation error (fix)
4. Determine if truly orphaned (delete)
```

---

### Type 4: Password Policies

**Purpose:** Enforce password complexity, expiration, and security standards.

#### Password Policy Rules

**Complexity requirements:**
```
Policy: Enterprise Password Standard

Requirements:
- Minimum length: 12 characters
- Must contain: 
  - Uppercase letter (A-Z)
  - Lowercase letter (a-z)
  - Number (0-9)
  - Special character (!@#$%^&*)
- Cannot contain: username, company name
- Cannot reuse: last 5 passwords

Enforcement:
Location: Password reset/change flows
Validation: Real-time during entry
Failure: Rejected with specific guidance
```

**Expiration policies:**
```
Policy: Password Age Limit

Rules:
- Maximum age: 90 days
- Warning before expiration: 14 days
- Grace period after expiration: 3 days

Timeline:
Day 0: Password set
Day 76: First warning (14 days remaining)
Day 83: Second warning (7 days remaining)
Day 87: Final warning (3 days remaining)
Day 90: Password expires
Day 91-93: Grace period (must change at login)
Day 94: Account locked until password reset
```

---

### Preventive vs Detective Policies

**Preventive (before access granted):**
```
Enforced at: Request time, provisioning time
Purpose: Stop violations before they occur
Examples:
- SoD check blocks request
- Risk policy requires extra approval
- Attribute policy denies contractors

Advantage: Prevents violations
Disadvantage: May block legitimate needs
```

**Detective (after access granted):**
```
Enforced at: Certification time, scheduled scans
Purpose: Identify existing violations  
Examples:
- Certification reveals SoD violation
- Inactive account scan finds orphans
- Audit identifies policy exceptions

Advantage: Finds existing issues
Disadvantage: Violation already exists
```

---

### Exam Tips

**Key concepts:**
✅ Four policy types: SoD, Access, Account, Password
✅ SoD prevents conflicting access (fraud prevention)
✅ Preventive vs detective enforcement
✅ Common SoD patterns (create+approve, request+approve)
✅ Access policies control eligibility
✅ Account policies detect lifecycle issues

**Remember:**
- SoD = Separation of Duties (conflicting access)
- Preventive = blocks before granting
- Detective = finds after granted
- SOX compliance drives many SoD requirements
- Policies can be hard (block) or soft (warn)

---

### Key Takeaways

✅ **SoD policies** - Prevent conflicting access combinations

✅ **Access policies** - Control who gets what access

✅ **Account policies** - Detect orphaned/inactive accounts

✅ **Password policies** - Enforce security standards

✅ **Two enforcement modes** - Preventive (block) vs Detective (find)

✅ **Compliance driven** - SOX, regulations require policies

✅ **Risk-based** - Policies reduce fraud and security risks

---

**Next Section:** 7.4.2 - Policy Configuration and Use Cases - Detailed policy setup, real-world scenarios, and best practices.

**Section 7.4.1 Complete!**
