# 6.2.1 Entitlement Basics and Structure

**Learning Objective:** Understand what entitlements are, how they're structured, and their role in access management.

---

## What is an Entitlement?

**Definition:** An entitlement is a specific permission, group membership, or access right within a source system that can be granted to an account

**Simple Explanation:**
```
Entitlement = A specific access item in a target system

Examples:
  Active Directory: "VPN-Users" group
  Salesforce: "Sales Cloud User" profile
  AWS: "S3ReadOnly" permission
  Database: "HR_READ" role
```

**Key Concept:**
```
Identity â†’ Account â†’ Entitlements

Example:
  Identity: John Smith
    â†“
  Account: AD account (john.smith)
    â†“
  Entitlements:
    - Domain Users (group)
    - VPN-Users (group)
    - Sales-Team (group)
    - Exchange-Users (group)
```

**Exam Tip:** Entitlements are the "things" you can have in a source system - groups, roles, permissions, licenses. They are discovered during aggregation.

---

## Entitlement vs. Account vs. Access

### **Understanding the Hierarchy**

**Identity (Person):**
```
The person in your organization

Example:
  Name: John Smith
  Employee ID: EMP12345
  Email: john.smith@company.com
  Department: Sales
```

**Account (Identity in a System):**
```
The user account in a specific target system

Example:
  Identity: John Smith
  
  Accounts:
    - Active Directory: john.smith
    - Salesforce: john.smith@company.com
    - Email: john.smith@company.com
    - VPN: john.smith
```

**Entitlement (Specific Access):**
```
The specific permissions/groups within an account

Example:
  Account: Active Directory (john.smith)
  
  Entitlements:
    - Domain Users (AD group)
    - VPN-Users (AD group)
    - Sales-Team (AD group)
    - File-Share-Sales (AD group)
```

**Complete Example:**
```
Identity: John Smith (person)
  â”‚
  â”œâ”€ Account: Active Directory (john.smith)
  â”‚   â”œâ”€ Entitlement: Domain Users
  â”‚   â”œâ”€ Entitlement: VPN-Users
  â”‚   â””â”€ Entitlement: Sales-Team
  â”‚
  â”œâ”€ Account: Salesforce (john.smith@company.com)
  â”‚   â”œâ”€ Entitlement: Sales Cloud User (profile)
  â”‚   â””â”€ Entitlement: Marketing Cloud User (permission set)
  â”‚
  â””â”€ Account: AWS (john.smith)
      â”œâ”€ Entitlement: Developer (IAM group)
      â””â”€ Entitlement: S3-ReadOnly (IAM policy)
```

---

## Types of Entitlements

### **Group Memberships**

**Most Common Type:**
```
Source: Active Directory
Entitlement Type: Groups

Examples:
  - Domain Users (default group)
  - VPN-Users (access group)
  - Sales-Team (department group)
  - HR-Admins (privileged group)
  - Finance-Shared-Drive (resource group)
  
Structure:
  Group Name: VPN-Users
  Group DN: CN=VPN-Users,OU=Groups,DC=company,DC=com
  Members: All users with VPN access
```

**Group Properties:**
```
Group Entitlement Details:

Name: VPN-Users
Type: Security Group
Description: Users with VPN access
Members: 450 accounts
Privileged: No
Business Purpose: Remote access
Owner: IT Operations
```

---

### **Roles**

**Role-Based Entitlements:**
```
Source: Database (Oracle, SQL Server)
Entitlement Type: Database Roles

Examples:
  - HR_READ (read access to HR data)
  - FINANCE_WRITE (write access to finance data)
  - DBA (database administrator role)
  - APP_USER (application user role)

Structure:
  Role Name: HR_READ
  Permissions: SELECT on HR schema
  Granted To: HR department users
```

**Application Roles:**
```
Source: SAP
Entitlement Type: SAP Roles

Examples:
  - SAP_HR_MANAGER (HR management functions)
  - SAP_FI_CLERK (finance clerk functions)
  - SAP_BUYER (purchasing functions)
  
Each role grants specific transactions/functions
```

---

### **Profiles**

**Profile-Based Entitlements:**
```
Source: Salesforce
Entitlement Type: Profiles

Examples:
  - System Administrator (full admin access)
  - Standard User (basic user access)
  - Sales Cloud User (sales features)
  - Marketing User (marketing features)
  - Read Only (view-only access)

Profile determines:
  - What objects can be accessed
  - What actions can be performed
  - What tabs are visible
  - What features are enabled
```

**Profile Structure:**
```
Profile Entitlement: Sales Cloud User

Includes:
  Object Permissions:
    - Accounts: Read, Create, Edit
    - Contacts: Read, Create, Edit
    - Opportunities: Read, Create, Edit
    - Cases: Read only
    
  Tab Access:
    - Accounts, Contacts, Opportunities visible
    
  System Permissions:
    - API Enabled
    - Export Reports
```

---

### **Permission Sets**

**Additional Permissions:**
```
Source: Salesforce
Entitlement Type: Permission Sets

Examples:
  - Marketing Cloud Access
  - Advanced Reporting
  - API Integration
  - Custom Object Access

Purpose:
  Extend profile permissions
  Grant additional access beyond base profile
  More flexible than profiles
```

**How They Work:**
```
User has:
  Base Profile: Standard User
  + Permission Set: Marketing Cloud Access
  + Permission Set: Advanced Reporting
  = Total Access

Additive model:
  Profile provides base access
  Permission sets add more access
  Never subtract permissions
```

---

### **Licenses**

**License-Based Entitlements:**
```
Source: Microsoft 365
Entitlement Type: Licenses

Examples:
  - Office 365 E3 (standard license)
  - Office 365 E5 (premium license)
  - Teams (Teams license)
  - Power BI Pro (BI license)
  - Visio Online (Visio license)

Each license grants:
  - Access to specific applications
  - Feature availability
  - Storage quotas
```

**License Structure:**
```
License: Office 365 E3

Includes:
  - Exchange Online (email)
  - SharePoint Online (collaboration)
  - Teams (communication)
  - OneDrive (storage - 1TB)
  - Office apps (Word, Excel, PowerPoint)
  
Does NOT include:
  - Advanced threat protection (E5 feature)
  - Power BI Pro (separate license)
  - Phone System (E5 feature)
```

---

### **Permissions/Privileges**

**Granular Permissions:**
```
Source: AWS
Entitlement Type: IAM Policies

Examples:
  - AmazonS3ReadOnlyAccess
  - AmazonEC2FullAccess
  - IAMUserChangePassword
  - CloudWatchReadOnlyAccess

Structure:
  Policy defines allowed/denied actions
  Very granular control
  JSON-based definition
```

**Permission Example:**
```
Policy: AmazonS3ReadOnlyAccess

Allows:
  - s3:GetObject (read files)
  - s3:ListBucket (list files)
  
Denies:
  - s3:PutObject (upload files)
  - s3:DeleteObject (delete files)
  
Read-only access to S3 buckets
```

---

## Entitlement Structure in ISC

### **Entitlement Attributes**

**Core Attributes:**
```
Every entitlement in ISC has:

1. Name
   - Display name of the entitlement
   - Example: "VPN-Users"

2. Value
   - Actual value/identifier
   - Example: "CN=VPN-Users,OU=Groups,DC=company,DC=com"

3. Type
   - Category of entitlement
   - Example: "group", "role", "permission"

4. Source
   - Which source system it came from
   - Example: "Active Directory"

5. Attribute Name
   - Which account attribute contains it
   - Example: "memberOf" (for AD groups)

6. Description (optional)
   - Human-readable description
   - Example: "Users with VPN access"

7. Owner (optional)
   - Business owner of the entitlement
   - Example: "IT Operations Team"

8. Risk Level (optional)
   - Risk score (Low, Medium, High)
   - Example: "High" for admin groups
```

---

### **Active Directory Entitlement Example**

**Complete Entitlement Structure:**
```
Entitlement Details:

Basic Information:
  Name: VPN-Users
  Display Name: VPN-Users
  Value: CN=VPN-Users,OU=Groups,DC=company,DC=com
  Type: group
  Source: Active Directory
  Attribute: memberOf

Technical Details:
  Distinguished Name: CN=VPN-Users,OU=Groups,DC=company,DC=com
  Object Class: group
  Group Type: Security Group
  Group Scope: Global
  
Metadata:
  Description: Users authorized for VPN access
  Owner: IT Operations
  Created: 2020-05-15
  Modified: 2024-02-10
  Members: 450 accounts
  
Classification:
  Risk Level: Medium
  Privileged: No
  Requestable: Yes
  Requires Approval: Yes (manager approval)
  
Business Context:
  Business Purpose: Remote access to company network
  Access Guidelines: Required for remote workers
  Compliance: SOX not applicable
```

---

### **Salesforce Entitlement Example**

**Profile Entitlement:**
```
Entitlement Details:

Basic Information:
  Name: Sales Cloud User
  Display Name: Sales Cloud User
  Value: 00exx000001abcd (Salesforce Profile ID)
  Type: profile
  Source: Salesforce Production
  Attribute: ProfileId

Technical Details:
  Profile ID: 00exx000001abcd
  License Type: Salesforce
  User Type: Standard
  
Metadata:
  Description: Standard profile for sales team members
  Owner: Sales Operations
  Active Users: 150
  
Permissions Included:
  - Create/Edit Accounts
  - Create/Edit Contacts
  - Create/Edit Opportunities
  - View Reports
  - Export Data
  
Classification:
  Risk Level: Low
  Privileged: No
  Requestable: Yes
  Requires Approval: Yes (sales manager approval)
```

---

## How Entitlements Are Discovered

### **Aggregation Process**

**Discovery During Aggregation:**
```
Step 1: ISC aggregates accounts from source
  Connect to Active Directory
  Find all user accounts
  
Step 2: ISC reads account attributes
  For each account, read:
    - sAMAccountName: john.smith
    - memberOf: (list of groups)
    
Step 3: ISC discovers entitlements
  memberOf attribute contains:
    - CN=Domain Users,OU=Groups,DC=company,DC=com
    - CN=VPN-Users,OU=Groups,DC=company,DC=com
    - CN=Sales-Team,OU=Groups,DC=company,DC=com
    
Step 4: ISC catalogs entitlements
  Creates entitlement objects:
    - Domain Users (entitlement)
    - VPN-Users (entitlement)
    - Sales-Team (entitlement)
    
Step 5: ISC links entitlements to accounts
  Account: john.smith
  Has entitlements:
    - Domain Users
    - VPN-Users
    - Sales-Team
```

**First Aggregation:**
```
Before aggregation:
  - ISC doesn't know what entitlements exist
  - Entitlement catalog is empty
  
During first aggregation:
  - ISC discovers all groups/roles/permissions
  - Creates entitlement catalog
  - Links entitlements to accounts
  
After aggregation:
  - ISC knows all available entitlements
  - Can show what each account has
  - Can provision entitlements to new users
```

---

### **Entitlement Aggregation Example**

**Active Directory Aggregation:**
```
Source: Active Directory
Aggregation Schedule: Daily at 2 AM

Day 1 - First Aggregation:
  
  Discovered Accounts: 5,000
  
  Discovered Entitlements: 250 groups
    - Domain Users
    - VPN-Users
    - Sales-Team
    - IT-Admins
    - Finance-Users
    - HR-Team
    ... (244 more groups)
    
  Account-to-Entitlement Mappings: 15,000
    (Each account has average 3 groups)
    
  Result:
    âœ“ Entitlement catalog created
    âœ“ 250 entitlements now visible in ISC
    âœ“ Can see who has what access
```

**Ongoing Aggregation:**
```
Day 2 - Incremental Aggregation:
  
  New entitlements discovered: 2
    - Marketing-Team (newly created group)
    - Sales-Admins (newly created group)
    
  Entitlement changes: 15
    - 10 accounts added to VPN-Users
    - 5 accounts removed from Sales-Team
    
  Result:
    âœ“ Entitlement catalog updated
    âœ“ 252 total entitlements
    âœ“ Account entitlements refreshed
```

---

## Entitlement Naming and Display

### **Technical Name vs. Display Name**

**Technical Name (Value):**
```
The actual identifier in the source system

Active Directory:
  Technical: CN=VPN-Users,OU=Groups,DC=company,DC=com
  Format: Distinguished Name (DN)
  Used by: System for provisioning
  
Salesforce:
  Technical: 00exx000001abcd
  Format: Salesforce ID
  Used by: System for API calls
  
AWS:
  Technical: arn:aws:iam::123456789012:policy/S3ReadOnly
  Format: ARN (Amazon Resource Name)
  Used by: System for API calls
```

**Display Name (Friendly Name):**
```
Human-readable name shown to users

Active Directory:
  Display: VPN-Users
  Friendly: Users with VPN access
  Shown to: End users, managers
  
Salesforce:
  Display: Sales Cloud User
  Friendly: Standard Sales Profile
  Shown to: Access requestors
  
AWS:
  Display: S3 Read Only Access
  Friendly: Read-only access to S3 buckets
  Shown to: Users requesting access
```

**Why Both Matter:**
```
Technical Name:
  âœ“ Used for provisioning (exact identifier)
  âœ“ System-to-system communication
  âœ“ API calls
  âœ“ Must be precise
  
Display Name:
  âœ“ Shown to users (human-friendly)
  âœ“ Access request catalogs
  âœ“ Certification reviews
  âœ“ Reporting
```

---

## Entitlement Hierarchy

### **Parent-Child Relationships**

**Nested Groups (Active Directory):**
```
Parent Group: Sales-Team
  â”‚
  â”œâ”€ Child Group: Sales-West
  â”‚   â””â”€ Members: Western sales reps
  â”‚
  â”œâ”€ Child Group: Sales-East
  â”‚   â””â”€ Members: Eastern sales reps
  â”‚
  â””â”€ Child Group: Sales-International
      â””â”€ Members: International sales reps

Membership:
  John (member of Sales-West)
    â†’ Inherits: Sales-Team membership
    
  Jane (member of Sales-East)
    â†’ Inherits: Sales-Team membership
```

**Role Hierarchies (Salesforce):**
```
CEO
 â”‚
 â”œâ”€ VP Sales
 â”‚   â””â”€ Sales Manager
 â”‚       â””â”€ Sales Rep
 â”‚
 â””â”€ VP Engineering
     â””â”€ Engineering Manager
         â””â”€ Software Engineer

Access Inheritance:
  CEO sees: All records
  VP Sales sees: All sales records
  Sales Manager sees: Team's records
  Sales Rep sees: Own records
  
Hierarchical access control
```

---

## Entitlement Classification

### **Risk Levels**

**Low Risk:**
```
Examples:
  - Domain Users (AD)
  - Standard User (Salesforce)
  - Basic Read Access (Database)
  
Characteristics:
  - Standard business access
  - Minimal permissions
  - Low security impact
  - Self-service requestable
```

**Medium Risk:**
```
Examples:
  - VPN-Users (AD)
  - Department Admin (Application)
  - Write Access (Database)
  
Characteristics:
  - Elevated permissions
  - Broader access
  - Requires justification
  - Manager approval required
```

**High Risk:**
```
Examples:
  - Domain Admins (AD)
  - System Administrator (Salesforce)
  - DBA (Database)
  - Root Access (Linux)
  
Characteristics:
  - Privileged access
  - Extensive permissions
  - High security impact
  - Multi-level approval required
  - Regular recertification
```

---

### **Privileged Entitlements**

**What Makes an Entitlement Privileged:**
```
Criteria:
  âœ“ Administrative access
  âœ“ Ability to grant access to others
  âœ“ Access to sensitive data
  âœ“ System configuration rights
  âœ“ Security-related permissions

Examples:
  Active Directory:
    - Domain Admins
    - Enterprise Admins
    - Schema Admins
    - Account Operators
    
  Salesforce:
    - System Administrator
    - Modify All Data
    
  AWS:
    - AdministratorAccess
    - IAMFullAccess
    
  Database:
    - DBA
    - SYSTEM
    - SA (SQL Server)
```

**Special Handling:**
```
Privileged entitlements require:
  âœ“ Additional approval levels
  âœ“ Justification documentation
  âœ“ Time-limited grants (JIT - Just In Time)
  âœ“ Frequent recertification (monthly/quarterly)
  âœ“ Enhanced monitoring
  âœ“ Audit logging
  âœ“ Emergency access procedures
```

---

## Entitlement Lifecycle

### **Lifecycle States**

**Active Entitlements:**
```
State: Active
Status: Available for provisioning
Requestable: Yes

Example:
  Entitlement: VPN-Users
  State: Active
  Can be:
    - Requested by users
    - Provisioned to accounts
    - Included in roles
    - Certified in campaigns
```

**Inactive Entitlements:**
```
State: Inactive
Status: Not available for provisioning
Requestable: No

Example:
  Entitlement: Legacy-App-Access
  State: Inactive
  Reason: Application decommissioned
  
  Cannot be:
    - Requested by users
    - Provisioned to new accounts
    
  Can still:
    - Exist on old accounts
    - Be removed during cleanup
```

**Deprecated Entitlements:**
```
State: Deprecated
Status: Being phased out
Requestable: No (new requests)

Example:
  Entitlement: Old-VPN-Group
  State: Deprecated
  Replacement: New-VPN-Users
  
  Cannot be:
    - Requested for new users
    
  Can be:
    - Retained by existing users (temporarily)
    - Removed during cleanup
    - Replaced with new entitlement
```

---

## Practice Exercise

**Question:** A company has aggregated Active Directory and discovered the following groups. Classify each entitlement and explain its structure:

1. Domain Users
2. VPN-Users
3. Domain Admins
4. Sales-Team

<details>
<summary>Answer</summary>

**Entitlement Classification and Structure:**

---

**Entitlement 1: Domain Users**

**Classification:**
```
Entitlement Type: Group (Active Directory)
Risk Level: Low
Privileged: No
Requestable: No (automatic/default)
```

**Complete Structure:**
```
Basic Information:
  Name: Domain Users
  Display Name: Domain Users
  Value: CN=Domain Users,CN=Users,DC=company,DC=com
  Type: Security Group
  Source: Active Directory
  Attribute: memberOf

Technical Details:
  Distinguished Name: CN=Domain Users,CN=Users,DC=company,DC=com
  Object Class: group
  Group Type: Security Group
  Group Scope: Global
  SID: S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-513
  
Membership:
  Members: ~5,000 (all domain users)
  Membership Type: Automatic
  Primary Group: Yes (default for all users)
```

**Characteristics:**
```
Purpose:
  - Default group for all domain users
  - Automatic membership (cannot be removed)
  - Provides baseline domain access
  
Permissions:
  - Basic domain user rights
  - Read access to domain resources
  - No administrative permissions
  
Access Level: Standard/Default
```

**Risk Assessment:**
```
Risk Level: Low

Why Low Risk:
  âœ“ Everyone has this membership
  âœ“ Minimal permissions
  âœ“ Standard business access
  âœ“ Cannot perform administrative actions
  âœ“ No sensitive data access
  
Security Impact: Minimal
  - Default group
  - No elevated privileges
  - Standard user access only
```

**Provisioning Behavior:**
```
Provisioning: Automatic

How it works:
  - New AD account created
  â†’ Automatically added to Domain Users
  - No manual provisioning needed
  - Cannot remove (primary group)
  
ISC Handling:
  - Not requestable (automatic)
  - Not included in access catalogs
  - Always present on AD accounts
  - No approval required (default)
```

**Certification Approach:**
```
Certification: Not typically certified

Why:
  - Universal membership
  - Automatic/default
  - No business decision needed
  - Every AD account has it
  
Exception:
  - May certify in comprehensive reviews
  - Verify account should still exist
  - But not certify THIS specific entitlement
```

---

**Entitlement 2: VPN-Users**

**Classification:**
```
Entitlement Type: Group (Active Directory)
Risk Level: Medium
Privileged: No
Requestable: Yes
```

**Complete Structure:**
```
Basic Information:
  Name: VPN-Users
  Display Name: VPN-Users
  Friendly Name: Users with VPN Access
  Value: CN=VPN-Users,OU=Groups,DC=company,DC=com
  Type: Security Group
  Source: Active Directory
  Attribute: memberOf

Technical Details:
  Distinguished Name: CN=VPN-Users,OU=Groups,DC=company,DC=com
  Object Class: group
  Group Type: Security Group
  Group Scope: Global
  SID: S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-1234
  
Membership:
  Members: 450 accounts
  Membership Type: Managed (via ISC)
  Dynamic: No (explicitly assigned)
```

**Characteristics:**
```
Purpose:
  - Grants VPN access to remote users
  - Allows connection to corporate network remotely
  - Required for work-from-home
  
Permissions:
  - VPN authentication
  - Remote access to internal resources
  - Standard user permissions (once connected)
  
Access Level: Standard (but controlled)
```

**Risk Assessment:**
```
Risk Level: Medium

Why Medium Risk:
  âš  Provides remote network access
  âš  Extends perimeter beyond office
  âš  Authentication vector
  âš  Requires justification
  
Not High Risk because:
  âœ“ No administrative permissions
  âœ“ Still subject to network controls
  âœ“ Standard user access (post-connection)
  âœ“ MFA typically required
  
Security Considerations:
  - VPN access = potential attack vector
  - Must have business need
  - Subject to remote access policies
  - MFA enforcement recommended
```

**Provisioning Behavior:**
```
Provisioning: Managed/Requestable

How it works:
  1. User requests VPN access
  2. Justification required: "Work from home 3 days/week"
  3. Manager approval required
  4. ISC provisions: Add to VPN-Users group
  5. User can connect via VPN
  
Request Workflow:
  Request â†’ Manager Approval â†’ Provision â†’ User Notified
  
Approval Requirements:
  - Manager approval: Required
  - Business justification: Required
  - IT approval: Optional (auto-approved if manager approved)
```

**Access Request Details:**
```
Catalog Entry:
  Name: VPN Access
  Description: Remote access to corporate network
  Requires: Manager approval
  Provisioning Time: 15 minutes
  
Request Form:
  - Justification (required)
  - Work from home schedule (optional)
  - Duration (optional, default: permanent)
  
Automatic Provisioning:
  Upon approval:
    âœ“ Add user to VPN-Users group
    âœ“ User can connect within 15 minutes
    âœ“ MFA enrollment (if not already)
```

**Certification Approach:**
```
Certification: Yes (quarterly)

Review Questions:
  - Does employee still work remotely?
  - Is VPN access still required?
  - Has employee's role changed?
  
Reviewer: Manager
Frequency: Quarterly
Action on Revocation: Remove from VPN-Users group

Typical Results:
  - 95% certified (retain access)
  - 5% revoked (no longer needed)
```

**Metadata:**
```
Business Context:
  Owner: IT Operations
  Business Purpose: Remote access for distributed workforce
  Compliance: SOX controls apply (access review)
  Cost: No direct cost (VPN infrastructure exists)
  
Technical Context:
  VPN Platform: Cisco AnyConnect
  MFA Required: Yes (Duo)
  Access Level: Standard user (post-connection)
  Network Restrictions: Some internal resources restricted
```

---

**Entitlement 3: Domain Admins**

**Classification:**
```
Entitlement Type: Group (Active Directory)
Risk Level: High / Critical
Privileged: Yes
Requestable: Yes (highly restricted)
```

**Complete Structure:**
```
Basic Information:
  Name: Domain Admins
  Display Name: Domain Admins
  Friendly Name: Domain Administrators (Privileged)
  Value: CN=Domain Admins,CN=Users,DC=company,DC=com
  Type: Security Group (Privileged)
  Source: Active Directory
  Attribute: memberOf

Technical Details:
  Distinguished Name: CN=Domain Admins,CN=Users,DC=company,DC=com
  Object Class: group
  Group Type: Security Group
  Group Scope: Global
  SID: S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-512
  Built-in: Yes (default AD group)
  
Membership:
  Members: 3-5 accounts (highly restricted)
  Membership Type: Tightly controlled
  Emergency Access: Break-glass account exists
```

**Characteristics:**
```
Purpose:
  - Full administrative control over AD domain
  - Can modify any object in domain
  - Can grant/revoke any permission
  - Critical for domain management
  
Permissions (Full Admin):
  âœ“ Create/delete any AD object
  âœ“ Modify Group Policy
  âœ“ Grant any permission
  âœ“ Reset any password
  âœ“ Modify security settings
  âœ“ Install domain controllers
  âœ“ Everything in AD domain
  
Access Level: Privileged Administrative
```

**Risk Assessment:**
```
Risk Level: Critical / High

Why Critical Risk:
  ðŸ”´ Complete domain control
  ðŸ”´ Can compromise entire AD environment
  ðŸ”´ Can grant themselves any access
  ðŸ”´ Can cover tracks (modify logs if permissions allow)
  ðŸ”´ Potential for massive data breach
  ðŸ”´ Compliance violations if misused
  
Security Impact: Severe
  - Unauthorized use = complete compromise
  - Misuse can affect all 5,000 users
  - Can disable security controls
  - Can create backdoor accounts
  
Highly Sensitive:
  âœ“ SOX critical access
  âœ“ Audit scrutiny
  âœ“ Executive visibility
  âœ“ Board-level reporting
```

**Provisioning Behavior:**
```
Provisioning: Highly Restricted

Request Process:
  1. User requests Domain Admin access
  2. Detailed justification required
  3. Multi-level approval:
     - Manager approval
     - IT Director approval
     - CISO approval
     - CIO approval (for permanent access)
  4. Security review
  5. Background check verification
  6. Provision (if all approvals granted)
  
Approval Requirements:
  - Manager: Required
  - IT Management: Required
  - Security: Required
  - Executive: Required (permanent)
  
Automatic Rejection Conditions:
  - Insufficient justification
  - No business need
  - Alternative exists (least privilege)
  - Failed background check
```

**Time-Limited Access (JIT - Just In Time):**
```
Preferred Model: Temporary Access

Standard Approach:
  - Grant for specific task: 4-8 hours
  - Auto-revoke after time expires
  - Re-request if needed again
  
Example:
  Request: "Need to modify GPO for security update"
  Approved for: 4 hours
  Granted: 2024-02-14 10:00 AM
  Auto-revoke: 2024-02-14 2:00 PM
  
  User completes task
  Access automatically removed
  Must re-request if needed again
  
Permanent Access:
  - Only for: Dedicated AD admins (2-3 people)
  - Requires: Executive approval
  - Subject to: Monthly recertification
```

**Certification Approach:**
```
Certification: Monthly (high frequency)

Review Process:
  - Every 30 days
  - Review all Domain Admin members
  - Detailed justification review
  - Alternative assessment
  
Review Questions:
  - Is admin access still required?
  - Can role be performed with lower privilege?
  - Has job function changed?
  - Any security incidents?
  
Reviewer: IT Director + CISO
Action on Revocation: Immediate removal

Typical Results:
  - Permanent members: Recertified (2-3 people)
  - Temporary members: Reviewed case-by-case
  - 0 tolerance for unnecessary access
```

**Monitoring and Auditing:**
```
Enhanced Monitoring:
  âœ“ All actions logged
  âœ“ SIEM alerts on Domain Admin use
  âœ“ Real-time notifications to security team
  âœ“ Quarterly audit reports
  âœ“ Compliance reporting (SOX, PCI, etc.)
  
Alerts:
  - Domain Admin login: Notify security
  - Group modification: Immediate alert
  - Permission changes: Logged and reviewed
  - After-hours use: Flagged for review
  
Audit Trail:
  - Who has access (current list)
  - Who had access (historical)
  - When granted/revoked
  - Approval chain
  - Certification results
```

**Metadata:**
```
Business Context:
  Owner: IT Director
  Business Purpose: Active Directory administration
  Compliance: SOX critical, PCI scope, HIPAA applicable
  Cost: No direct cost
  
Technical Context:
  Scope: Entire AD domain
  Impact: All 5,000 users
  Dependencies: Domain controllers, GPOs, entire AD
  
Governance:
  Policy: Privileged Access Management Policy
  SLA: 4-hour emergency grant available
  Break-glass: Emergency account exists
  Documentation: All uses must be documented
```

---

**Entitlement 4: Sales-Team**

**Classification:**
```
Entitlement Type: Group (Active Directory)
Risk Level: Low
Privileged: No
Requestable: Yes (department-based)
```

**Complete Structure:**
```
Basic Information:
  Name: Sales-Team
  Display Name: Sales-Team
  Friendly Name: Sales Department Team
  Value: CN=Sales-Team,OU=Groups,DC=company,DC=com
  Type: Security Group (Department)
  Source: Active Directory
  Attribute: memberOf

Technical Details:
  Distinguished Name: CN=Sales-Team,OU=Groups,DC=company,DC=com
  Object Class: group
  Group Type: Security Group
  Group Scope: Global
  SID: S-1-5-21-xxxxxxxxxx-xxxxxxxxxx-xxxxxxxxxx-5678
  
Membership:
  Members: 250 accounts (all sales employees)
  Membership Type: Role-based (department)
  Dynamic: Can be automated based on department attribute
```

**Characteristics:**
```
Purpose:
  - Groups all sales department members
  - Provides access to sales resources
  - Used for email distribution
  - Resource permissions (shared drives, etc.)
  
Permissions:
  - Sales shared drive access
  - Sales distribution list
  - Sales applications
  - Sales reports access
  
Access Level: Department-standard
```

**Risk Assessment:**
```
Risk Level: Low

Why Low Risk:
  âœ“ Department-specific access
  âœ“ Standard business resources
  âœ“ No administrative permissions
  âœ“ Limited to sales data/tools
  âœ“ Appropriate for role
  
Security Impact: Minimal
  - Sales data access (appropriate for sales)
  - No cross-department data
  - No privileged permissions
  - Standard user access
  
Not Sensitive:
  - Sales information (not confidential internally)
  - Sales tools (business-appropriate)
  - Team collaboration (expected)
```

**Provisioning Behavior:**
```
Provisioning: Automated (department-based)

Automatic Assignment:
  IF identity.department = "Sales"
  THEN add to Sales-Team group
  
Joiner Workflow:
  1. New hire: John Smith
  2. Department: Sales (in Workday)
  3. ISC aggregates from Workday
  4. Identity created: department = Sales
  5. Automated role assignment
  6. Provision to Sales-Team group
  7. User has sales access day one
  
Manual Request (if needed):
  - User requests Sales-Team access
  - Sales manager approval
  - Provision to group
  
Typical Flow: Automatic (90% of cases)
```

**Role-Based Assignment:**
```
Birthright Access:
  - All sales employees automatically get Sales-Team
  - Part of "Sales Employee" role
  - No manual request needed
  
Role Definition:
  Role: Sales Employee
    IF department = "Sales"
    THEN grant:
      - Sales-Team (AD group)
      - Salesforce access
      - Sales shared drive
      - Sales distribution list
      
  Automatic and consistent access
```

**Certification Approach:**
```
Certification: Quarterly (standard)

Review Process:
  - Quarterly access review
  - Manager certifies team members
  - Validate department membership
  
Review Questions:
  - Is employee still in sales?
  - Should they have sales resource access?
  
Reviewer: Sales Manager
Frequency: Quarterly
Action on Revocation: Remove from Sales-Team

Typical Results:
  - 98% certified (still in sales)
  - 2% revoked (transferred to different department)
  
Automated Cleanup:
  - If department changes in HR system
  - ISC detects department change
  - Automatically removes from Sales-Team
  - Adds to new department group
```

**Metadata:**
```
Business Context:
  Owner: Sales Operations
  Business Purpose: Sales team collaboration and resource access
  Compliance: Not SOX critical (standard business)
  Cost: No direct cost
  
Technical Context:
  Resources Granted:
    - \\fileserver\sales (shared drive)
    - sales-team@company.com (distribution list)
    - Salesforce app access
    - Sales reports folder
    
  Dependencies:
    - File server permissions
    - Email distribution lists
    - Application access controls
```

---

**Comparison Summary:**

| Entitlement | Type | Risk | Privileged | Requestable | Approval | Certification |
|-------------|------|------|------------|-------------|----------|---------------|
| **Domain Users** | Group | Low | No | No (automatic) | N/A | No |
| **VPN-Users** | Group | Medium | No | Yes | Manager | Quarterly |
| **Domain Admins** | Group | Critical | Yes | Yes (restricted) | Multi-level | Monthly |
| **Sales-Team** | Group | Low | No | Yes (auto) | Auto/Manager | Quarterly |

---

**Key Learning Points:**
```
1. Entitlement Structure:
   - Every entitlement has technical (value) and display names
   - Metadata includes risk, owner, purpose
   - Classification drives access controls
   
2. Risk Levels Vary:
   - Low: Standard access (Domain Users, Sales-Team)
   - Medium: Controlled access (VPN-Users)
   - High/Critical: Privileged access (Domain Admins)
   
3. Provisioning Approaches:
   - Automatic: Default groups (Domain Users)
   - Role-based: Department groups (Sales-Team)
   - Requestable: Controlled access (VPN-Users)
   - Highly restricted: Privileged access (Domain Admins)
   
4. Certification Frequency:
   - No cert: Default groups
   - Quarterly: Standard entitlements
   - Monthly: Privileged entitlements
   
5. Approval Requirements:
   - None: Automatic entitlements
   - Manager: Standard entitlements
   - Multi-level: Privileged entitlements
```

**Exam Tip:** Know how to classify entitlements by risk level. Privileged/admin groups = High risk, controlled access groups = Medium risk, default/department groups = Low risk. Risk level determines approval requirements and certification frequency.
</details>

---

## Section Summary

**Core Concepts for Certification:**

âœ… **Entitlement Definition:**
- Specific permission, group, role, or access in a source system
- Examples: AD groups, Salesforce profiles, AWS policies
- Discovered during aggregation
- Linked to accounts (not identities directly)

âœ… **Hierarchy:**
- Identity (person) â†’ Account (system identity) â†’ Entitlement (specific access)
- Example: John Smith â†’ AD account â†’ VPN-Users group

âœ… **Types of Entitlements:**
- **Groups**: AD security groups, distribution lists
- **Roles**: Database roles, application roles
- **Profiles**: Salesforce profiles, user types
- **Permission Sets**: Additional permissions, licenses
- **Permissions**: Granular permissions, policies (AWS, Azure)

âœ… **Entitlement Structure:**
- **Name**: Display name (VPN-Users)
- **Value**: Technical identifier (DN, ID, ARN)
- **Type**: Category (group, role, permission)
- **Source**: Which system (Active Directory)
- **Metadata**: Description, owner, risk level

âœ… **Risk Classification:**
- **Low**: Standard access (Domain Users, department groups)
- **Medium**: Controlled access (VPN, write access)
- **High**: Privileged access (Domain Admins, DBA, root)

âœ… **Discovery Process:**
- Aggregation discovers accounts
- Reads account attributes (memberOf, ProfileId, etc.)
- Catalogs entitlements
- Links entitlements to accounts
- Creates entitlement catalog in ISC

âœ… **Privileged Entitlements:**
- Administrative access (Domain Admins, sysadmin)
- Require enhanced controls (multi-approval, JIT, frequent cert)
- High security impact
- Extra monitoring and auditing

**Exam Focus Areas:**
- Know entitlement = specific access in source system
- Understand Identity â†’ Account â†’ Entitlement hierarchy
- Remember entitlements discovered during aggregation
- Know different types (groups, roles, profiles, permissions)
- Understand risk classification (low/medium/high)
- Know privileged entitlements require special handling
- Remember technical name (value) vs. display name

---

**End of Section 6.2.1: Entitlement Basics and Structure**

**Next:** Section 6.2.2: Entitlement Aggregation

---

**Study Tips:**
- **Entitlement**: Specific access in a source (group, role, permission)
- **Hierarchy**: Identity â†’ Account â†’ Entitlement
- **Discovery**: Aggregation finds entitlements
- **Types**: Groups (AD), Roles (DB), Profiles (SF), Permissions (AWS)
- **Risk**: Low (standard), Medium (controlled), High (privileged)
- **Privileged**: Admin groups need special controls
- **Structure**: Name (display) + Value (technical identifier)
