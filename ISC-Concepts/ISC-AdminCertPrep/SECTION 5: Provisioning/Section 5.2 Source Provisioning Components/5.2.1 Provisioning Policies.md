
# Section 5.2: Source Provisioning Components

**Master the components that enable provisioning in ISC sources**

---

## Table of Contents

- [5.2.1 Provisioning Policies](#521-provisioning-policies)
- [5.2.2 Create, Update, Delete Operations](#522-create-update-delete-operations)
- [5.2.3 Account Schemas and Attributes](#523-account-schemas-and-attributes)

---

# 5.2.1 Provisioning Policies

**Learning Objective:** Understand provisioning policies and how they control provisioning behavior.

---

## What is a Provisioning Policy?

**Definition:** Configuration that defines how ISC provisions to a specific source

**Purpose:**
```
Provisioning Policy determines:
  - Can this source be provisioned?
  - What operations are allowed? (Create, Modify, Delete)
  - What attributes to provision?
  - What provisioning method to use?
  - When provisioning occurs?
```

**Simple concept:**
```
Provisioning Policy = Rules for how ISC provisions to a source

Example:
  Source: Active Directory
  Provisioning Policy: Defines how to create/modify/delete AD accounts
```

**Exam Tip:** Provisioning policy configures HOW provisioning happens for a source. Each source has its own provisioning policy.

---

## Provisioning Policy Components

### **Core Settings**

**1. Provisioning Enabled/Disabled**
```
Setting: Enable provisioning for this source?

Options:
  ✓ Enabled: ISC can provision to this source
  ✗ Disabled: ISC cannot provision (read-only)

Example:
  Active Directory: Enabled (can provision)
  HR System (Workday): Disabled (read-only, authoritative source)
```

**Why disable provisioning:**
```
Authoritative sources:
  - Workday (HR data)
  - SuccessFactors
  - HR databases
  
  Reason: ISC reads from these, doesn't write to them
  
Read-only sources:
  - Legacy systems
  - Sources being decommissioned
  - Testing/staging environments
  
  Reason: Don't want ISC making changes
```

---

**2. Allowed Operations**

**Configure which operations permitted:**

| Operation | What It Does | When Enabled |
|-----------|-------------|--------------|
| **Create** | Create new accounts | New hires, new access |
| **Update** | Modify existing accounts | Attribute changes, group adds |
| **Delete** | Remove accounts | Terminations, access removal |
| **Enable** | Activate accounts | Return from leave |
| **Disable** | Deactivate accounts | Termination, leave |

**Example configurations:**

**Configuration 1: Full Provisioning**
```
Source: Active Directory (production)

Allowed Operations:
  ✓ Create (new accounts)
  ✓ Update (modify attributes, groups)
  ✓ Enable (re-enable accounts)
  ✓ Disable (terminate/suspend)
  ✓ Delete (after retention period)

Use Case: Primary account source, full lifecycle
```

**Configuration 2: Create and Update Only**
```
Source: Salesforce

Allowed Operations:
  ✓ Create (new accounts)
  ✓ Update (modify profiles, licenses)
  ✗ Delete (never delete, just disable)
  ✓ Enable (activate accounts)
  ✓ Disable (deactivate)

Use Case: Keep all historical data, never delete
```

**Configuration 3: Update Only**
```
Source: Active Directory (testing)

Allowed Operations:
  ✗ Create (accounts pre-created manually)
  ✓ Update (can modify attributes)
  ✗ Delete (never delete test accounts)

Use Case: Testing environment, pre-existing accounts
```

---

**3. Provisioning Method**

**How ISC provisions:**

**Method 1: Direct Provisioning (Cloud Sources)**
```
ISC → API Call → Target System

Example - Salesforce:
  ISC calls Salesforce API directly
  No VA required
  Real-time provisioning
  
Advantages:
  ✓ Fast (direct connection)
  ✓ No VA dependency
  ✓ Simple architecture
  
Use Cases:
  - Cloud SaaS apps
  - Modern applications with APIs
```

**Method 2: VA-Based Provisioning (On-Premises)**
```
ISC → VA → Target System

Example - Active Directory:
  ISC sends command to VA
  VA executes PowerShell/LDAP
  VA reports result to ISC
  
Advantages:
  ✓ Can reach on-premises systems
  ✓ Secure (no inbound connections)
  
Disadvantages:
  ✗ Slower (VA in middle)
  ✗ VA dependency
  
Use Cases:
  - Active Directory
  - On-premises databases
  - Legacy systems
```

**Method 3: File-Based Provisioning**
```
ISC → Generate File → Target System Imports

Example - HR System:
  ISC generates CSV file
  File placed on SFTP server
  HR system imports file nightly
  
Advantages:
  ✓ Works with legacy systems
  ✓ Batch processing
  
Disadvantages:
  ✗ Delayed (not real-time)
  ✗ Manual coordination needed
  
Use Cases:
  - Legacy systems without APIs
  - Batch processing requirements
```

---

**4. Provisioning Timing**

**When provisioning executes:**

**Real-time (Immediate):**
```
Trigger → Provisioning executes immediately

Example:
  User lifecycle changes to active
    ↓
  Within minutes: AD account created
  
Use Cases:
  ✓ High-priority provisioning (new hires)
  ✓ Security-critical (de-provisioning)
  ✓ User-requested access
  
Duration: Minutes
```

**Scheduled (Batch):**
```
Trigger → Queued → Executes at scheduled time

Example:
  User assigned role at 10 AM
    ↓
  Queued for next batch
    ↓
  Batch runs at 2 PM
    ↓
  Account created at 2 PM
  
Use Cases:
  ✓ Bulk operations
  ✓ Low-priority changes
  ✓ System resource management
  
Duration: Hours (until next batch)
```

**Configuration:**
```
Provisioning Policy Settings:

Real-time Operations:
  - Account creation (new hires)
  - Account disabling (terminations)
  - High-risk access grants
  
Batch Operations:
  - Bulk group updates
  - Attribute synchronization
  - Non-urgent changes
  
Schedule:
  Batch Window: Every 2 hours
  Next Run: :00 minutes past the hour
```

---

**5. Attribute Mapping**

**Which attributes to provision:**
```
Provisioning Policy defines:
  - Which ISC attributes map to source attributes
  - Which attributes are provisioned
  - Default values
  - Transforms/calculations
```

**Example - Active Directory:**
```
ISC Attribute → AD Attribute

firstName → givenName
lastName → sn
email → mail
displayName → displayName (firstName + " " + lastName)
department → department
manager → manager (DN lookup)
employeeID → employeeID
```

**Provisioning behavior:**
```
When creating AD account:
  
ISC has identity:
  firstName: "John"
  lastName: "Smith"
  email: "john.smith@company.com"
  department: "Sales"
  
Provisioning Policy maps:
  givenName = "John"
  sn = "Smith"
  mail = "john.smith@company.com"
  department = "Sales"
  displayName = "John Smith" (calculated)
  
AD account created with these attributes
```

---

**6. Before/After Provisioning Rules**

**Custom logic before/after provisioning:**

**Before Provisioning Rules:**
```
Execute before account creation

Use Cases:
  - Validate data
  - Generate username (if not provided)
  - Check for conflicts
  - Calculate attributes
  
Example:
  Before creating AD account:
    1. Check if username already exists
    2. If exists, append number (john.smith2)
    3. Proceed with creation
```

**After Provisioning Rules:**
```
Execute after account creation

Use Cases:
  - Verify success
  - Trigger additional actions
  - Send notifications
  - Update external systems
  
Example:
  After creating AD account:
    1. Verify account created successfully
    2. Send welcome email to user
    3. Create ticket for equipment
    4. Update HR system with AD username
```

---

## Provisioning Policy Examples

### **Example 1: Active Directory (Full Lifecycle)**
```yaml
Source: Active Directory

Provisioning Policy:
  
  Enabled: Yes
  
  Allowed Operations:
    Create: Yes
    Update: Yes
    Enable: Yes
    Disable: Yes
    Delete: Yes (after 90 days)
  
  Provisioning Method: Via Virtual Appliance
  
  Timing:
    Create: Real-time (immediate)
    Update: Real-time
    Disable: Real-time (urgent)
    Delete: Scheduled (90 days post-termination)
  
  Attribute Mappings:
    sAMAccountName: identity.uid
    givenName: identity.firstName
    sn: identity.lastName
    displayName: identity.displayName
    mail: identity.email
    department: identity.department
    employeeID: identity.employeeNumber
    manager: identity.manager (DN lookup)
  
  OU Placement:
    Default: OU=Users,DC=company,DC=com
    By Department:
      Sales: OU=Sales,OU=Users,DC=company,DC=com
      IT: OU=IT,OU=Users,DC=company,DC=com
  
  Default Groups:
    - All-Employees
    - Domain Users
    
  Password Policy:
    Generate: Random, 16 characters
    Must Change: On first login
    
  Before Provisioning:
    - Check username uniqueness
    - Validate email format
    
  After Provisioning:
    - Send welcome email
    - Add to security groups based on department
```

---

### **Example 2: Salesforce (Create and Update Only)**
```yaml
Source: Salesforce

Provisioning Policy:
  
  Enabled: Yes
  
  Allowed Operations:
    Create: Yes
    Update: Yes
    Enable: Yes
    Disable: Yes
    Delete: No (never delete, historical data)
  
  Provisioning Method: Direct API
  
  Timing:
    Create: Real-time
    Update: Real-time
    Disable: Real-time
  
  Attribute Mappings:
    Username: identity.email
    Email: identity.email
    FirstName: identity.firstName
    LastName: identity.lastName
    Department: identity.department
    ProfileId: Based on department (rule)
    UserRoleId: Based on title (rule)
  
  Default Settings:
    Profile: Standard User
    License: Sales Cloud
    TimeZone: America/New_York
    Locale: en_US
    
  Profile Assignment Rules:
    IF department = "Sales" → Profile: Sales User
    IF department = "IT" → Profile: System Administrator
    ELSE → Profile: Standard User
  
  After Provisioning:
    - Assign to default permission sets
    - Notify user with login instructions
```

---

### **Example 3: Workday (Read-Only, No Provisioning)**
```yaml
Source: Workday (HR System)

Provisioning Policy:
  
  Enabled: No
  
  Reason: Authoritative source, read-only
  
  ISC Behavior:
    Aggregation: Yes (read employee data)
    Provisioning: No (never write to HR)
  
  Note: 
    HR owns employee data
    ISC consumes data only
    All updates made in Workday
```

---

## Provisioning Policy Best Practices

### **Design Principles**

**1. Least Privilege**
```
Enable only operations needed:

✓ Good:
  Source: Application
  Create: Yes (need to create accounts)
  Update: Yes (need to modify)
  Delete: No (application keeps historical data)

✗ Bad:
  Source: Application
  Create: Yes
  Update: Yes
  Delete: Yes (enabled but never used = unnecessary risk)
```

---

**2. Authoritative Sources Read-Only**
```
✓ Good:
  Source: Workday (HR)
  Provisioning: Disabled
  Reason: Authoritative source
  
✗ Bad:
  Source: Workday
  Provisioning: Enabled
  Reason: ISC should never modify HR data
```

---

**3. Real-time for Security**
```
✓ Good:
  Operations requiring immediate execution:
    - Account creation (new hires)
    - Account disabling (terminations)
    - Access revocation (security)
  Timing: Real-time
  
✗ Bad:
  Termination provisioning: Batch (runs every 4 hours)
  Risk: Terminated employee has access for hours
```

---

**4. Document Policies**
```
✓ Good:
  Provisioning Policy: Active Directory
  Operations: Create, Update, Disable, Delete
  Timing: Real-time except Delete (90 days)
  Notes: 
    - Delete delayed for retention
    - Manager DN looked up from employeeId
  Last Updated: 2024-02-14
  Owner: IAM Team
```

---

**5. Test Before Production**
```
Process:
  1. Configure policy in test/sandbox
  2. Test each operation (create, update, delete)
  3. Verify attribute mappings
  4. Test error handling
  5. Deploy to production
  6. Monitor first provisioning operations
```

---

## Practice Exercise

**Question:** You're configuring a provisioning policy for Active Directory. What operations should you enable and what timing should you use for each?

<details>
<summary>Answer</summary>

**Recommended Active Directory Provisioning Policy:**

---

**Operations Configuration:**

**1. Create - ENABLED (Real-time)**
```
Enabled: Yes
Timing: Real-time (immediate)

Why Enabled:
  ✓ Need to create accounts for new hires
  ✓ Need to create accounts for access requests
  ✓ Core provisioning requirement
  
Why Real-time:
  ✓ New employees need access on day one
  ✓ Cannot wait for batch processing
  ✓ Business expectation: immediate provisioning
  
Use Cases:
  - New hire starts (lifecycle: prehire → active)
  - User requests AD account
  - Contractor onboarding
  
Example:
  Employee starts today at 8 AM
  Lifecycle changes at 2 AM (aggregation)
  AD account created at 2:05 AM
  Ready for employee arrival
```

---

**2. Update - ENABLED (Real-time)**
```
Enabled: Yes
Timing: Real-time (immediate)

Why Enabled:
  ✓ Attributes change (department, manager, title)
  ✓ Group memberships change
  ✓ Keep AD synchronized with ISC
  
Why Real-time:
  ✓ Department changes need immediate group updates
  ✓ Manager changes affect access
  ✓ Keep data current
  
Use Cases:
  - Department transfer (Sales → IT)
  - Promotion (update title)
  - Manager change
  - Group membership changes
  
Update Operations Include:
  - Modify attributes (department, title, manager)
  - Add to groups
  - Remove from groups
  - Update contact information
  
Example:
  Employee transfers IT → Sales
  Workday aggregates
  ISC updates AD:
    - Department: IT → Sales
    - Remove from: IT-All group
    - Add to: Sales-Team group
  Completed within minutes
```

---

**3. Enable - ENABLED (Real-time)**
```
Enabled: Yes
Timing: Real-time (immediate)

Why Enabled:
  ✓ Re-enable accounts after leave
  ✓ Re-enable accidentally disabled accounts
  ✓ Support return from leave workflow
  
Why Real-time:
  ✓ Employee returning from leave needs immediate access
  ✓ Cannot wait for batch
  
Use Cases:
  - Return from leave (leave → active)
  - Accidentally disabled, need to re-enable
  - Account reactivation
  
Example:
  Employee returns from maternity leave
  Lifecycle: leave → active
  Return workflow triggers:
    - Enable AD account
    - Remove "Account is disabled" flag
    - User can log in immediately
```

---

**4. Disable - ENABLED (Real-time, URGENT)**
```
Enabled: Yes
Timing: Real-time (IMMEDIATE - highest priority)

Why Enabled:
  ✓ Must disable accounts on termination
  ✓ Must disable for leave of absence
  ✓ Security requirement
  
Why Real-time (URGENT):
  ✓ Security critical
  ✓ Terminated employee must lose access immediately
  ✓ Cannot tolerate any delay
  ✓ Compliance requirement
  
Priority: HIGHEST (executed before other operations)
  
Use Cases:
  - Termination (active → inactive)
  - Leave of absence (active → leave)
  - Security incident (immediate revocation)
  
Example:
  Employee terminated today
  Lifecycle: active → inactive
  Leaver workflow triggers:
    - Disable AD account (within 2 minutes)
    - User cannot log in
    - Active sessions may be terminated (GPO)
    - VPN disconnected
  
Security Impact:
  ✓ Immediate access revocation
  ✓ No window for malicious activity
  ✓ Compliance satisfied
```

---

**5. Delete - ENABLED (Scheduled/Delayed)**
```
Enabled: Yes
Timing: Scheduled (90 days after disable)

Why Enabled:
  ✓ Cleanup old disabled accounts
  ✓ Reduce account sprawl
  ✓ Free up usernames
  ✓ Compliance (data retention end)
  
Why Delayed (90 days):
  ✓ Retention period for data access
  ✓ Manager may need to access files
  ✓ Legal hold considerations
  ✓ Re-hire possibility
  
Why NOT Immediate:
  ✗ Data would be lost
  ✗ Manager can't access forwarded email
  ✗ May violate retention policy
  ✗ Cannot recover if mistake
  
Process:
  Day 0: Disable account (immediate)
  Day 1-89: Account disabled, data preserved
  Day 90: Delete account (scheduled job)
  
Deletion Schedule:
  Job: "Delete accounts disabled >90 days"
  Frequency: Weekly (Sunday 3 AM)
  Checks:
    - Account disabled for 90+ days?
    - No legal holds?
    - No active tickets?
    - Retention period complete?
  Then: Delete account
  
Example:
  Employee terminated: Feb 14, 2024
  Account disabled: Feb 14, 2024 (Day 0)
  Account deleted: May 14, 2024 (Day 90)
  
  Deletion job runs May 19, 2024 (Sunday)
    - Finds account disabled 94 days ago
    - No holds
    - Deletes account
```

---

**Complete Configuration:**
```yaml
Source: Active Directory

Provisioning Policy:
  
  Enabled: Yes
  Method: Virtual Appliance
  
  Operations:
  
    Create:
      Enabled: Yes
      Timing: Real-time
      Priority: High
      Retry: 3 attempts
      
    Update:
      Enabled: Yes
      Timing: Real-time
      Priority: Medium
      Retry: 3 attempts
      Batch Updates: Group to reduce load
      
    Enable:
      Enabled: Yes
      Timing: Real-time
      Priority: High
      Retry: 2 attempts
      
    Disable:
      Enabled: Yes
      Timing: Real-time
      Priority: CRITICAL (highest)
      Retry: 5 attempts (ensure success)
      Alert on Failure: Yes (immediate)
      
    Delete:
      Enabled: Yes
      Timing: Scheduled (90 days post-disable)
      Schedule: Weekly (Sunday 3 AM)
      Conditions:
        - Disabled for 90+ days
        - No legal holds
        - No active tickets
        - Retention period complete
      Approval: Automatic (if conditions met)
      Notification: IT Team (weekly summary)
```

---

**Why This Configuration:**

**Security:**
```
✓ Disable is real-time and highest priority
  - Immediate access revocation
  - Security incidents handled instantly
  - Compliance satisfied

✓ Delete is delayed
  - Data preserved for transition
  - No accidental data loss
  - Meets retention requirements
```

**Business Continuity:**
```
✓ Create and Enable are real-time
  - New hires ready on day one
  - Returns from leave have immediate access
  - Business productivity maintained

✓ Update is real-time
  - Department transfers processed quickly
  - Access changes immediate
  - Data stays current
```

**Operational Efficiency:**
```
✓ Automated deletion after retention
  - Consistent enforcement
  - Reduces account sprawl
  - Frees IT from manual cleanup

✓ Batch updates for low-priority changes
  - Reduces VA load
  - Optimizes performance
  - Groups similar operations
```

**Risk Management:**
```
✓ Disable never waits (highest priority)
  - Zero tolerance for delayed revocation
  - Multiple retries ensure success
  - Alerts on failure

✓ Delete is controlled and scheduled
  - Cannot accidentally delete
  - Retention period enforced
  - Reversible during disable period
```

---

**What NOT to Enable:**

**Operations to Avoid:**

**Immediate Deletion:**
```
✗ DON'T Configure:
  Delete:
    Timing: Real-time (immediate on termination)

Why Not:
  ✗ Data lost immediately
  ✗ Cannot recover
  ✗ Manager can't access files
  ✗ Violates retention policies
  ✗ Risk of mistakes

Instead:
  ✓ Disable immediately
  ✓ Delete after retention period
```

**Batch Disable:**
```
✗ DON'T Configure:
  Disable:
    Timing: Batch (every 4 hours)

Why Not:
  ✗ Security gap (hours of access)
  ✗ Terminated employee can still log in
  ✗ Compliance violation
  ✗ Unacceptable risk

Instead:
  ✓ Disable real-time (immediate)
  ✓ Highest priority
```

---

**Exam Tip:** For AD provisioning, enable all operations but with different timing: Create/Update/Enable/Disable are real-time, Delete is delayed (90 days). Disable has highest priority for security.
</details>

---

# 5.2.2 Create, Update, Delete Operations

**Learning Objective:** Understand the three core provisioning operations and how they work.

---

## Provisioning Operations Overview

### **Three Core Operations**

| Operation | Purpose | When Used | Example |
|-----------|---------|-----------|---------|
| **Create** | Make new account | New hire, new access | Create AD account for new employee |
| **Update** | Modify existing account | Attribute changes, group adds | Update department, add to group |
| **Delete** | Remove account | Termination, access removal | Delete AD account after retention |

**Additional operations:**
- **Enable**: Activate disabled account
- **Disable**: Deactivate account (soft delete)

**Exam Tip:** Create makes new accounts, Update modifies existing accounts, Delete removes accounts. Most sources support all three.

---

## Create Operation

### **What is Create?**

**Definition:** Provisioning operation that creates a new account in the target system

**When Create occurs:**
```
Triggers:
  - New hire (lifecycle: prehire → active)
  - Access request approved (new access)
  - Role assigned (requires new account)
  - Manual admin creates account
```

### **Create Process**

**Step-by-step:**
```
1. ISC determines account needed
   Example: Employee needs AD account

2. ISC gathers required attributes
   Collects:
     - Username (uid)
     - First name, last name
     - Email
     - Department
     - Initial groups

3. ISC applies provisioning policy
   Maps ISC attributes to target attributes:
     ISC: firstName → AD: givenName
     ISC: lastName → AD: sn
     ISC: email → AD: mail

4. ISC sends create command
   Via VA (on-prem) or direct API (cloud)

5. Target system creates account
   AD: New-ADUser executed
   Account created

6. Target system responds
   Success: Account created
   Failure: Error message

7. ISC records result
   Success: Account linked to identity
   Failure: Retry or alert admin
```

### **Create Example - Active Directory**

**Scenario: Create AD account for new employee**
```
Identity: John Smith
  uid: john.smith
  firstName: John
  lastName: Smith
  email: john.smith@company.com
  department: Sales
  employeeNumber: EMP12345
  manager: Jane Doe

ISC Create Operation:

1. Gather Attributes:
   sAMAccountName: john.smith
   givenName: John
   sn: Smith
   displayName: John Smith
   mail: john.smith@company.com
   department: Sales
   employeeID: EMP12345
   manager: CN=Jane Doe,OU=Users,DC=company,DC=com

2. Generate Password:
   Password: Random 16-character
   mustChangePassword: True

3. Determine OU:
   Based on department:
     Sales → OU=Sales,OU=Users,DC=company,DC=com

4. Assign Groups:
   Default groups:
     - Domain Users (automatic)
     - All-Employees
     - VPN-Users
   Department groups:
     - Sales-Team

5. Send Command to VA:
   Operation: Create
   Source: Active Directory
   Attributes: [above]
   OU: OU=Sales,OU=Users,DC=company,DC=com
   Groups: [above]

6. VA Executes PowerShell:
   New-ADUser -Name "john.smith" `
     -GivenName "John" `
     -Surname "Smith" `
     -DisplayName "John Smith" `
     -SamAccountName "john.smith" `
     -UserPrincipalName "john.smith@company.com" `
     -EmailAddress "john.smith@company.com" `
     -Department "Sales" `
     -EmployeeID "EMP12345" `
     -Manager "CN=Jane Doe,OU=Users,DC=company,DC=com" `
     -Path "OU=Sales,OU=Users,DC=company,DC=com" `
     -AccountPassword (ConvertTo-SecureString "P@ssw0rd123!" -AsPlainText -Force) `
     -ChangePasswordAtLogon $true `
     -Enabled $true

   Add-ADGroupMember -Identity "All-Employees" -Members "john.smith"
   Add-ADGroupMember -Identity "VPN-Users" -Members "john.smith"
   Add-ADGroupMember -Identity "Sales-Team" -Members "john.smith"

7. VA Reports Success:
   Account Created: john.smith
   Groups Added: All-Employees, VPN-Users, Sales-Team
   Status: Success

8. ISC Updates Records:
   Identity: John Smith
     Accounts:
       - Active Directory: john.smith (NEW)
   
   Provisioning Log:
     Operation: Create
     Source: Active Directory
     Account: john.smith
     Status: Success
     Timestamp: 2024-02-14 10:30:15
```

---

### **Create Example - Salesforce**

**Scenario: Create Salesforce account**
```
Identity: John Smith
  email: john.smith@company.com
  firstName: John
  lastName: Smith
  department: Sales

ISC Create Operation:

1. Gather Attributes:
   Username: john.smith@company.com
   Email: john.smith@company.com
   FirstName: John
   LastName: Smith
   Department: Sales
   ProfileId: Standard User (looked up)
   UserRoleId: Sales Rep (based on department)

2. Assign License:
   License: Sales Cloud

3. Send API Call:
   POST /services/data/v58.0/sobjects/User
   
   Body:
   {
     "Username": "john.smith@company.com",
     "Email": "john.smith@company.com",
     "FirstName": "John",
     "LastName": "Smith",
     "Department": "Sales",
     "ProfileId": "00exx000001abcd",
     "UserRoleId": "00Exx000000efgh",
     "Alias": "jsmith",
     "TimeZoneSidKey": "America/New_York",
     "LocaleSidKey": "en_US",
     "EmailEncodingKey": "UTF-8",
     "LanguageLocaleKey": "en_US"
   }

4. Salesforce Creates User:
   User Created
   User ID: 005xx000001234AAA

5. Salesforce Responds:
   {
     "id": "005xx000001234AAA",
     "success": true
   }

6. ISC Records:
   Identity: John Smith
     Accounts:
       - Salesforce: john.smith@company.com (NEW)
   
   Salesforce Account ID: 005xx000001234AAA
```

---

## Update Operation

### **What is Update?**

**Definition:** Provisioning operation that modifies an existing account

**When Update occurs:**
```
Triggers:
  - Attribute changes (department, title, manager)
  - Group membership changes (add/remove groups)
  - Role changes
  - Access profile changes
  - Manual admin updates
```

### **Update Process**

**Step-by-step:**
```
1. ISC detects change needed
   Example: Employee transferred to new department

2. ISC identifies account to update
   Find existing account in target system

3. ISC determines what to change
   Compare current vs. desired state

4. ISC sends update command
   Only changed attributes sent (delta)

5. Target system updates account
   Modifies specified attributes/groups

6. Target system responds
   Success or failure

7. ISC records update
   Log what changed
```

### **Update Types**

**Type 1: Attribute Update**
```
Scenario: Employee department changes

Before:
  department: IT

After:
  department: Sales

Update Operation:
  ISC sends: Set department = "Sales"
  AD updates: Department attribute changed
  Result: department now shows "Sales"
```

**Type 2: Group Membership Update (Add)**
```
Scenario: Employee needs VPN access

Operation: Add to group

ISC sends:
  Add john.smith to VPN-Users group

AD executes:
  Add-ADGroupMember -Identity "VPN-Users" -Members "john.smith"

Result:
  john.smith now member of VPN-Users
  User can access VPN
```

**Type 3: Group Membership Update (Remove)**
```
Scenario: Employee no longer needs sales tools

Operation: Remove from group

ISC sends:
  Remove john.smith from Sales-Tools group

AD executes:
  Remove-ADGroupMember -Identity "Sales-Tools" -Members "john.smith"

Result:
  john.smith no longer member
  Access to sales tools revoked
```

**Type 4: Multi-Attribute Update**
```
Scenario: Employee promoted

Changes:
  title: "Developer" → "Senior Developer"
  department: "IT" → "Engineering"
  manager: "Bob Wilson" → "Jane Doe"

Update Operation:
  ISC sends:
    Set title = "Senior Developer"
    Set department = "Engineering"
    Set manager = "CN=Jane Doe,OU=Users,DC=company,DC=com"

AD updates all three attributes in single operation

Result: All attributes updated
```

---

### **Update Example - Department Transfer**

**Scenario: Employee moves IT → Sales**
```
Employee: John Smith
Current:
  department: IT
  Member of: IT-All, IT-Dev-Team
  
New:
  department: Sales
  Should be member of: Sales-Team, Sales-Tools

ISC Update Operation:

1. Attribute Update:
   Change department: IT → Sales
   
   Command:
     Set-ADUser -Identity "john.smith" -Department "Sales"

2. Remove Old Groups:
   Remove from IT groups
   
   Commands:
     Remove-ADGroupMember -Identity "IT-All" -Members "john.smith"
     Remove-ADGroupMember -Identity "IT-Dev-Team" -Members "john.smith"

3. Add New Groups:
   Add to Sales groups
   
   Commands:
     Add-ADGroupMember -Identity "Sales-Team" -Members "john.smith"
     Add-ADGroupMember -Identity "Sales-Tools" -Members "john.smith"

4. Result:
   department: Sales ✓
   Groups:
     ✓ Sales-Team (new)
     ✓ Sales-Tools (new)
     ✗ IT-All (removed)
     ✗ IT-Dev-Team (removed)

5. ISC Logs:
   Operation: Update
   Account: john.smith
   Changes:
     - department: IT → Sales
     - Groups removed: IT-All, IT-Dev-Team
     - Groups added: Sales-Team, Sales-Tools
   Status: Success
```

---

## Delete Operation

### **What is Delete?**

**Definition:** Provisioning operation that removes an account from the target system

**When Delete occurs:**
```
Triggers:
  - Termination (after retention period)
  - Access removal (revoke access)
  - Cleanup of old accounts
  - Compliance deletion requirements
```

### **Delete vs. Disable**

**Critical difference:**

| Aspect | Disable | Delete |
|--------|---------|--------|
| **Account** | Exists, inactive | Removed completely |
| **Data** | Preserved | Lost |
| **Reversible** | Yes (re-enable) | No (must recreate) |
| **When** | Immediate (Day 0) | After retention (Day 90) |
| **Security** | Access blocked | Access blocked |

**Recommended approach:**
```
Day 0 (Termination):
  ✓ Disable account (immediate)
  
Day 30-90 (Retention complete):
  ✓ Delete account (cleanup)
```

---

### **Delete Process**

**Step-by-step:**
```
1. ISC determines delete needed
   Example: Account disabled for 90 days, retention complete

2. ISC verifies delete conditions
   Checks:
     - Retention period complete?
     - No legal holds?
     - No active tickets?

3. ISC sends delete command
   Operation: Delete account

4. Target system deletes account
   Account removed permanently

5. Target system responds
   Success: Account deleted
   Failure: Error (e.g., account has dependencies)

6. ISC records deletion
   Log deletion event
   Remove account link from identity
   Preserve audit trail
```

---

### **Delete Example - Active Directory**

**Scenario: Delete account after 90-day retention**
Account: john.smith
Status: Disabled for 94 days
Termination Date: Feb 14, 2024
Current Date: May 19, 2024
Legal Holds: None
Retention Policy: 90 days
ISC Delete Operation:

Verify Conditions:
✓ Disabled for 94 days (>90 required)
✓ No legal holds
✓ No active tickets
✓ Retention period complete
Send Delete Command to VA:
Operation: Delete
Account: john.smith
Source: Active Directory
VA Executes PowerShell:
Remove-ADUser -Identity "john.smith" -Confirm:$false
AD Deletes Account:
Account: john.smith
Status: Deleted (moved to Deleted Objects for tombstone period)
All data: Removed
Group memberships: Removed
Cannot be recovered (except from backup)
VA Reports Success:
Account Deleted: john.smith
Status: Success
ISC Updates Records:
Identity: John Smith
cloudLifecycleState: inactive
Accounts:
- Active Directory: (removed from list)
Deletion Log:
Operation: Delete
Account: john.smith
Source: Active Directory
Reason: Retention period complete (90 days)
Deleted By: Automated cleanup job
Timestamp: 2024-05-19 03:15:22
Audit Trail Preserved:

Identity record kept (inactive)
Historical account information preserved
All access history preserved
Deletion event logged
