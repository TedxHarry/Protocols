# 5.4.3 Searching for Provisioning Errors

**Learning Objective:** Learn how to effectively search for and identify provisioning errors in ISC and VA logs.

---

## Searching for Errors Overview

**Purpose:**
```
Find and diagnose provisioning failures:
  - Identify failed operations
  - Locate error messages
  - Gather context
  - Determine root cause
  - Plan remediation
```

**Search Locations:**
```
Two primary places to search:
  1. ISC UI (Activity Search)
  2. VA Logs (connector.log files)
```

**Exam Tip:** Search ISC Activity first for high-level errors, then search VA logs for detailed diagnostic information.

---

## Searching in ISC UI

### **Activity Search**

**Navigation:**
```
ISC UI:
  Admin → Activity → Search
```

**Primary Filters:**
```
Available Filters:
  - Type (Provisioning, Aggregation, etc.)
  - Source (Active Directory, Salesforce, etc.)
  - Status (Success, Failed, Pending)
  - Date Range
  - Identity
  - Account
```

### **Basic Provisioning Error Search**

**Find All Failed Provisioning:**
```
Filter Configuration:
  Type: Provisioning
  Status: Failed
  Date Range: Last 7 days
  
Click: Search

Results:
  - All failed provisioning operations
  - Sorted by date (newest first)
  - Shows identity, source, operation
```

**Find Failures for Specific Source:**
```
Filter Configuration:
  Type: Provisioning
  Status: Failed
  Source: Active Directory
  Date Range: Last 7 days
  
Results:
  - Only AD provisioning failures
  - Easier to focus on one system
```

**Find Failures for Specific Identity:**
```
Filter Configuration:
  Type: Provisioning
  Status: Failed
  Identity: john.smith
  Date Range: Last 30 days
  
Results:
  - All provisioning failures for john.smith
  - Across all sources
  - Historical view
```

### **Viewing Error Details**

**Click on Failed Event:**
```
Event Details Panel Shows:
  
Header:
  - Event Type: Provisioning
  - Status: Failed
  - Timestamp: 2024-02-14 10:30:17
  - Duration: 2 seconds
  
Identity Information:
  - Identity: John Smith
  - Employee ID: EMP12345
  - Email: john.smith@company.com
  
Target Information:
  - Source: Active Directory
  - Account: john.smith (attempted)
  - Operation: Create Account
  
Error Information:
  - Error Message: "Account creation failed"
  - Error Code: LDAP_68
  - Error Details: "Entry already exists"
  - Stack Trace: (if available)
```

**Common Error Messages in ISC UI:**
```
Generic Errors:
  - "Account creation failed"
  - "Provisioning operation failed"
  - "Operation timed out"
  
Specific Errors:
  - "LDAP Error 68: Entry already exists"
  - "LDAP Error 50: Insufficient access rights"
  - "HTTP 401: Unauthorized"
  - "HTTP 404: User not found"
  - "Connection timeout"
```

### **Advanced Search Techniques**

**Search by Date/Time Range:**
```
Use Case: Issue occurred at specific time

Filter:
  Type: Provisioning
  Status: Failed
  Date Range: Custom
    From: 2024-02-14 10:00:00
    To: 2024-02-14 11:00:00
    
Results:
  Failures in specific 1-hour window
```

**Search by Operation Type:**
```
Filter by specific provisioning operation:

Available Operations:
  - Create Account
  - Update Account
  - Delete Account
  - Enable Account
  - Disable Account
  - Add Group Membership
  - Remove Group Membership
  
Filter:
  Type: Provisioning
  Operation: Create Account
  Status: Failed
  
Results:
  Only account creation failures
  Excludes update/delete/group failures
```

**Search Multiple Statuses:**
```
Find pending and failed:

Filter:
  Type: Provisioning
  Status: Failed, Pending
  Date Range: Last 24 hours
  
Use Case:
  - Find stuck provisioning operations
  - Operations that failed or are delayed
  - Investigate performance issues
```

---

## Searching in VA Logs

### **Log File Locations**

**Linux VA:**
```
Primary Log:
  /opt/sailpoint/logs/connector.log

Other Logs:
  /opt/sailpoint/logs/va.log
  /opt/sailpoint/logs/ccg.log
```

**Windows VA:**
```
Primary Log:
  C:\sailpoint\logs\connector.log

Other Logs:
  C:\sailpoint\logs\va.log
  C:\sailpoint\logs\ccg.log
```

### **Command-Line Search Tools**

**Using grep (Linux/Mac):**

**Basic Error Search:**
```bash
# Search for ERROR entries
grep "ERROR" /opt/sailpoint/logs/connector.log

# Search for ERROR in last 100 lines
tail -100 /opt/sailpoint/logs/connector.log | grep "ERROR"

# Search for ERROR with context (5 lines before/after)
grep -C 5 "ERROR" /opt/sailpoint/logs/connector.log

# Search for ERROR today
grep "2024-02-14" /opt/sailpoint/logs/connector.log | grep "ERROR"
```

**Search for Specific Error:**
```bash
# Search for specific error code
grep "LDAP Error 68" /opt/sailpoint/logs/connector.log

# Search for specific account
grep "john.smith" /opt/sailpoint/logs/connector.log

# Search for account creation failures
grep -i "account creation failed" /opt/sailpoint/logs/connector.log

# Case-insensitive search
grep -i "insufficient access" /opt/sailpoint/logs/connector.log
```

**Advanced grep Patterns:**
```bash
# Search for ERROR or WARN
grep -E "ERROR|WARN" /opt/sailpoint/logs/connector.log

# Search for multiple error codes
grep -E "LDAP Error (50|68|32)" /opt/sailpoint/logs/connector.log

# Search and save to file
grep "ERROR" /opt/sailpoint/logs/connector.log > errors.txt

# Count error occurrences
grep -c "ERROR" /opt/sailpoint/logs/connector.log

# Search with line numbers
grep -n "ERROR" /opt/sailpoint/logs/connector.log
```

**Using tail for Real-Time Monitoring:**
```bash
# Monitor log in real-time
tail -f /opt/sailpoint/logs/connector.log

# Monitor and filter for errors
tail -f /opt/sailpoint/logs/connector.log | grep "ERROR"

# Monitor last 100 lines continuously
tail -100 -f /opt/sailpoint/logs/connector.log
```

---

**Using Select-String (Windows PowerShell):**

**Basic Error Search:**
```powershell
# Search for ERROR entries
Select-String "ERROR" C:\sailpoint\logs\connector.log

# Get last 100 lines and search for ERROR
Get-Content C:\sailpoint\logs\connector.log -Tail 100 | Select-String "ERROR"

# Search with context (5 lines before/after)
Select-String "ERROR" C:\sailpoint\logs\connector.log -Context 5,5

# Search for ERROR today
Select-String "2024-02-14" C:\sailpoint\logs\connector.log | Select-String "ERROR"
```

**Advanced PowerShell Search:**
```powershell
# Case-insensitive search (default in PowerShell)
Select-String "insufficient access" C:\sailpoint\logs\connector.log

# Search for specific account
Select-String "john.smith" C:\sailpoint\logs\connector.log

# Search for multiple patterns
Select-String -Pattern "ERROR","WARN" C:\sailpoint\logs\connector.log

# Count occurrences
(Select-String "ERROR" C:\sailpoint\logs\connector.log).Count

# Save results to file
Select-String "ERROR" C:\sailpoint\logs\connector.log | Out-File errors.txt
```

---

### **Common Search Patterns**

**Search by Error Type:**

**LDAP Errors (Active Directory):**
```bash
# All LDAP errors
grep "LDAP Error" /opt/sailpoint/logs/connector.log

# Specific LDAP error codes
grep "LDAP Error 68" connector.log  # Entry already exists
grep "LDAP Error 50" connector.log  # Insufficient access
grep "LDAP Error 32" connector.log  # No such object
grep "LDAP Error 34" connector.log  # Invalid DN syntax
grep "LDAP Error 49" connector.log  # Invalid credentials
```

**HTTP/API Errors (Cloud Connectors):**
```bash
# HTTP errors
grep -E "HTTP (4|5)[0-9]{2}" connector.log

# Specific HTTP errors
grep "HTTP 401" connector.log  # Unauthorized
grep "HTTP 403" connector.log  # Forbidden
grep "HTTP 404" connector.log  # Not found
grep "HTTP 500" connector.log  # Internal server error
grep "HTTP 503" connector.log  # Service unavailable
```

**Database Errors (JDBC):**
```bash
# SQL errors
grep -i "SQLException" connector.log

# Connection errors
grep -i "connection" connector.log | grep -i "error"

# Timeout errors
grep -i "timeout" connector.log
```

**PowerShell Errors (AD):**
```bash
# PowerShell execution failures
grep "PowerShell execution failed" connector.log

# PowerShell error details
grep -A 10 "PowerShell execution failed" connector.log

# Specific PowerShell cmdlet errors
grep "New-ADUser" connector.log | grep "ERROR"
grep "Set-ADUser" connector.log | grep "ERROR"
```

---

**Search by Identity/Account:**
```bash
# Find all entries for specific user
grep "john.smith" connector.log

# Find errors for specific user
grep "john.smith" connector.log | grep "ERROR"

# Find account creation for user
grep "john.smith" connector.log | grep -i "creating"

# Find with context
grep -C 10 "john.smith" connector.log | grep "ERROR"
```

**Search by Time Range:**
```bash
# Find errors on specific date
grep "2024-02-14" connector.log | grep "ERROR"

# Find errors in specific hour
grep "2024-02-14 10:" connector.log | grep "ERROR"

# Find errors in time range (10:00-11:00)
grep "2024-02-14 10:" connector.log | grep "ERROR"
grep "2024-02-14 11:" connector.log | grep "ERROR"

# Extract specific time window
sed -n '/2024-02-14 10:30/,/2024-02-14 10:45/p' connector.log | grep "ERROR"
```

---

## Correlating ISC and VA Logs

### **Finding Related Events**

**Process:**
```
1. Find failure in ISC Activity
   - Note timestamp: 2024-02-14 10:30:17
   - Note identity: john.smith
   - Note source: Active Directory
   
2. Search VA logs for same timeframe
   - Search around timestamp (±5 minutes)
   - Search for identity name
   
3. Correlate events
   - Match ISC event to VA log entry
   - Get detailed error from VA log
```

**Example Correlation:**

**ISC Activity shows:**
```
Event: Provisioning Failed
Timestamp: 2024-02-14 10:30:17
Identity: John Smith
Source: Active Directory
Operation: Create Account
Error: "Account creation failed"
```

**Search VA logs:**
```bash
# Search around that timestamp
grep "2024-02-14 10:3[0-5]" connector.log | grep "john.smith"

# Or search for the account name
grep "john.smith" connector.log | grep "2024-02-14 10:"
```

**VA logs show:**
```
2024-02-14 10:30:15 DEBUG [AD-Connector] Creating user: john.smith
2024-02-14 10:30:16 DEBUG [AD-Connector] Command: New-ADUser -Name "john.smith"...
2024-02-14 10:30:17 ERROR [AD-Connector] PowerShell execution failed
2024-02-14 10:30:17 ERROR [AD-Connector] Error: New-ADUser : The specified account already exists
2024-02-14 10:30:17 ERROR [AD-Connector] LDAP Error 68: ENTRY_ALREADY_EXISTS
2024-02-14 10:30:17 ERROR [AD-Connector] DN: CN=john.smith,OU=Users,DC=company,DC=com
```

**Now you have:**
```
✓ High-level error from ISC
✓ Detailed error from VA logs
✓ Exact command executed
✓ Specific LDAP error code
✓ Full context
✓ Can diagnose root cause
```

---

## Common Error Patterns

### **LDAP Errors (Active Directory)**

**LDAP Error 68: ENTRY_ALREADY_EXISTS**
```
Error Message:
  "The specified account already exists"
  
Search Pattern:
  grep "LDAP Error 68" connector.log
  grep "ENTRY_ALREADY_EXISTS" connector.log
  
Root Cause:
  - Account already exists in AD
  - Duplicate creation attempt
  - Correlation issue
  
Resolution:
  - Check if account exists in AD
  - Correlate existing account to identity
  - Or use different username
```

**LDAP Error 50: INSUFFICIENT_ACCESS_RIGHTS**
```
Error Message:
  "Insufficient access rights to perform the operation"
  
Search Pattern:
  grep "LDAP Error 50" connector.log
  grep "INSUFFICIENT_ACCESS" connector.log
  
Root Cause:
  - Service account lacks permissions
  - Cannot create in specified OU
  - Cannot modify attribute
  
Resolution:
  - Grant permissions to service account
  - Verify OU delegation
  - Check attribute write permissions
```

**LDAP Error 32: NO_SUCH_OBJECT**
```
Error Message:
  "The object cannot be found"
  
Search Pattern:
  grep "LDAP Error 32" connector.log
  grep "NO_SUCH_OBJECT" connector.log
  
Root Cause:
  - OU path does not exist
  - Manager DN invalid
  - Reference to non-existent object
  
Resolution:
  - Verify OU exists in AD
  - Create missing OU
  - Fix DN reference
```

**LDAP Error 34: INVALID_DN_SYNTAX**
```
Error Message:
  "The object name has bad syntax"
  
Search Pattern:
  grep "LDAP Error 34" connector.log
  grep "INVALID_DN_SYNTAX" connector.log
  
Root Cause:
  - Malformed DN
  - Invalid characters in name
  - Incorrect DN format
  
Resolution:
  - Validate DN syntax
  - Remove invalid characters
  - Fix DN construction logic
```

**LDAP Error 49: INVALID_CREDENTIALS**
```
Error Message:
  "Invalid credentials"
  
Search Pattern:
  grep "LDAP Error 49" connector.log
  grep "INVALID_CREDENTIALS" connector.log
  
Root Cause:
  - Service account password wrong
  - Account disabled
  - Account locked
  
Resolution:
  - Update password in ISC
  - Unlock/enable service account
  - Verify credentials
```

---

### **HTTP/API Errors (Cloud Connectors)**

**HTTP 401: Unauthorized**
```
Error Message:
  "HTTP 401 Unauthorized"
  
Search Pattern:
  grep "HTTP 401" connector.log
  grep "Unauthorized" connector.log
  
Root Cause:
  - Authentication failed
  - OAuth token expired
  - Invalid credentials
  
Resolution:
  - Re-authenticate
  - Refresh OAuth token
  - Update credentials
```

**HTTP 403: Forbidden**
```
Error Message:
  "HTTP 403 Forbidden"
  
Search Pattern:
  grep "HTTP 403" connector.log
  grep "Forbidden" connector.log
  
Root Cause:
  - Insufficient permissions
  - API access denied
  - Feature not enabled
  
Resolution:
  - Grant API permissions
  - Enable required features
  - Update user role
```

**HTTP 429: Too Many Requests**
```
Error Message:
  "HTTP 429 Too Many Requests"
  "Rate limit exceeded"
  
Search Pattern:
  grep "HTTP 429" connector.log
  grep "Rate limit" connector.log
  grep "Too Many Requests" connector.log
  
Root Cause:
  - API rate limit reached
  - Too many requests in time window
  - Need to throttle
  
Resolution:
  - Reduce request frequency
  - Implement backoff/retry
  - Batch operations
  - Contact vendor for limit increase
```

**HTTP 500: Internal Server Error**
```
Error Message:
  "HTTP 500 Internal Server Error"
  
Search Pattern:
  grep "HTTP 500" connector.log
  grep "Internal Server Error" connector.log
  
Root Cause:
  - Target system error
  - API bug
  - Service outage
  
Resolution:
  - Retry operation
  - Check target system status
  - Contact vendor support
  - Wait for service restoration
```

---

### **Database Errors (JDBC)**

**Connection Timeout**
```
Error Message:
  "Connection timeout after 30 seconds"
  "Unable to connect to database"
  
Search Pattern:
  grep -i "connection timeout" connector.log
  grep -i "unable to connect" connector.log
  
Root Cause:
  - Database unreachable
  - Network issue
  - Firewall blocking
  - Database down
  
Resolution:
  - Verify database running
  - Check network connectivity
  - Verify firewall rules
  - Increase timeout if slow
```

**SQL Exception**
```
Error Message:
  "SQLException: ORA-00001: unique constraint violated"
  "SQLException: Duplicate entry"
  
Search Pattern:
  grep "SQLException" connector.log
  grep "ORA-" connector.log  # Oracle
  grep "Duplicate entry" connector.log  # MySQL
  
Root Cause:
  - Primary key violation
  - Unique constraint violation
  - Duplicate record
  
Resolution:
  - Check for existing record
  - Update instead of insert
  - Generate unique key
```

---

## Error Search Workflow

### **Step-by-Step Process**

**Step 1: Search ISC Activity**
```
Action:
  Admin → Activity → Search
  
Filters:
  Type: Provisioning
  Status: Failed
  Date Range: Relevant period
  
Review:
  - How many failures?
  - Which sources?
  - Which identities?
  - What operations?
  - Any patterns?
```

**Step 2: Identify Pattern**
```
Questions to ask:
  - Single identity or multiple?
  - Single source or multiple?
  - Single error or various?
  - Specific time or ongoing?
  - Recent change or longstanding?
```

**Step 3: Get Detailed Error**
```
For cloud connector:
  - Click on failed event
  - Review error details in ISC
  - May be sufficient
  
For VA connector:
  - Note timestamp and identity
  - Search VA logs
  - Get detailed error
```

**Step 4: Search VA Logs**
```
SSH/RDP to VA:
  cd /opt/sailpoint/logs
  
Search for identity:
  grep "john.smith" connector.log
  
Search around timestamp:
  grep "2024-02-14 10:3" connector.log | grep "ERROR"
  
Get context:
  grep -C 10 "john.smith" connector.log | grep -E "ERROR|WARN|DEBUG"
```

**Step 5: Analyze Error**
```
Review log output:
  - What operation was attempted?
  - What command/API call was made?
  - What exact error occurred?
  - What was the error code?
  - What context surrounds the error?
```

**Step 6: Determine Root Cause**
```
Based on error:
  - LDAP Error 68 → Account exists
  - LDAP Error 50 → Permission issue
  - HTTP 401 → Authentication failed
  - Connection timeout → Network/connectivity
  - SQL Exception → Database constraint
```

**Step 7: Plan Remediation**
```
Common fixes:
  - Grant permissions
  - Correlate existing accounts
  - Fix attribute mapping
  - Update credentials
  - Create missing OUs
  - Fix network connectivity
```

---

## Practice Exercise

**Question:** You receive a report that 5 AD account creations failed yesterday. Walk through how you would search for and analyze these errors using both ISC UI and VA logs.

<details>
<summary>Answer</summary>

**Complete Error Investigation Process:**

---

**STEP 1: Search ISC Activity UI**

**Action: Find the 5 failed account creations**
```
1. Navigate to Activity Search
   ISC UI → Admin → Activity → Search

2. Configure Filters
   Type: Provisioning
   Source: Active Directory
   Status: Failed
   Date Range: Yesterday (2024-02-13)
   Operation: Create Account (if available)
   
3. Click Search

4. Review Results
   Results show 5 failed events:
     Event 1: John Smith - 2024-02-13 09:15:22
     Event 2: Jane Doe - 2024-02-13 10:22:45
     Event 3: Bob Wilson - 2024-02-13 11:30:12
     Event 4: Alice Johnson - 2024-02-13 14:15:33
     Event 5: Mike Davis - 2024-02-13 15:45:18
```

---

**STEP 2: Analyze High-Level Patterns in ISC**

**Action: Click on each event to review details**

**Event 1: John Smith - 09:15:22**
```
Event Details:
  Identity: John Smith
  Employee ID: EMP12345
  Source: Active Directory
  Operation: Create Account
  Status: Failed
  Error Message: "Account creation failed"
  Error Code: None shown
  
  ⚠ Generic error - need VA logs for details
```

**Event 2: Jane Doe - 10:22:45**
```
Event Details:
  Identity: Jane Doe
  Employee ID: EMP12346
  Source: Active Directory
  Operation: Create Account
  Status: Failed
  Error Message: "LDAP Error 68: Entry already exists"
  
  ✓ Specific error! Account already exists
  ⚠ Still need VA logs for full context
```

**Event 3: Bob Wilson - 11:30:12**
```
Event Details:
  Identity: Bob Wilson
  Employee ID: EMP12347
  Source: Active Directory
  Operation: Create Account
  Status: Failed
  Error Message: "Account creation failed"
  
  ⚠ Generic error - need VA logs
```

**Event 4: Alice Johnson - 14:15:33**
```
Event Details:
  Identity: Alice Johnson
  Employee ID: EMP12348
  Source: Active Directory
  Operation: Create Account
  Status: Failed
  Error Message: "LDAP Error 50: Insufficient access rights"
  
  ✓ Specific error! Permission issue
  ⚠ Need VA logs to see which OU/operation
```

**Event 5: Mike Davis - 15:45:18**
```
Event Details:
  Identity: Mike Davis
  Employee ID: EMP12349
  Source: Active Directory
  Operation: Create Account
  Status: Failed
  Error Message: "Account creation failed"
  
  ⚠ Generic error - need VA logs
```

**Initial Pattern Analysis:**
```
5 failures total:
  - 2 with specific errors in ISC (Jane Doe, Alice Johnson)
  - 3 with generic errors (need VA logs)
  
Errors identified so far:
  - 1x LDAP Error 68 (Entry already exists)
  - 1x LDAP Error 50 (Insufficient access)
  - 3x Generic (unknown)
  
Conclusion: Need VA logs for complete picture
```

---

**STEP 3: Access VA Logs**

**Action: Download or access connector logs**

**Option A: Download from ISC UI**
```
1. Navigate to VA
   Admin → Virtual Appliances → VA-PROD-01
   
2. Download Logs
   Actions → Download Logs
   
3. Extract ZIP file
   Contains:
     - connector.log (most important)
     - va.log
     - ccg.log
     
4. Open connector.log
   Use text editor or grep/Select-String
```

**Option B: Direct SSH Access**
```
1. SSH to VA
   ssh admin@va-prod-01.company.com
   
2. Navigate to logs
   cd /opt/sailpoint/logs
   
3. Ready to search
   Will use grep commands
```

---

**STEP 4: Search VA Logs for Each Failure**

**Search for Event 1: John Smith - 09:15:22**
```bash
# Search by name and approximate time
grep "john.smith" connector.log | grep "2024-02-13 09:1[0-9]"

# Or search by time first, then filter
grep "2024-02-13 09:1[0-9]" connector.log | grep -i "smith"

# Get context around error
grep -C 15 "john.smith" connector.log | grep "2024-02-13 09:"
```

**Results:**
```
2024-02-13 09:15:20 DEBUG [AD-Connector] Creating user: john.smith
2024-02-13 09:15:20 DEBUG [AD-Connector] Department: null
2024-02-13 09:15:20 DEBUG [AD-Connector] Cannot determine OU - department is null
2024-02-13 09:15:21 ERROR [AD-Connector] Failed to build DN
2024-02-13 09:15:21 ERROR [AD-Connector] Missing required attribute: department
2024-02-13 09:15:22 ERROR [AD-Connector] Account creation failed: Cannot determine target OU

Root Cause: Department attribute is null
  - Cannot map to OU
  - OU placement requires department
  
Fix Needed:
  - Ensure department populated in identity
  - Or provide default OU when department missing
```

---

**Search for Event 2: Jane Doe - 10:22:45**
```bash
grep "jane.doe" connector.log | grep "2024-02-13 10:2[0-9]"
grep -C 15 "jane.doe" connector.log | grep "2024-02-13 10:"
```

**Results:**
```
2024-02-13 10:22:43 DEBUG [AD-Connector] Creating user: jane.doe
2024-02-13 10:22:43 DEBUG [AD-Connector] Target OU: OU=Sales,OU=Users,DC=company,DC=com
2024-02-13 10:22:44 DEBUG [AD-Connector] Executing: New-ADUser -Name "jane.doe" -SamAccountName "jane.doe" -Path "OU=Sales,OU=Users,DC=company,DC=com"
2024-02-13 10:22:45 ERROR [AD-Connector] PowerShell execution failed
2024-02-13 10:22:45 ERROR [AD-Connector] Error: New-ADUser : The specified account already exists
2024-02-13 10:22:45 ERROR [AD-Connector] LDAP Error 68: ENTRY_ALREADY_EXISTS
2024-02-13 10:22:45 ERROR [AD-Connector] DN: CN=jane.doe,OU=Sales,OU=Users,DC=company,DC=com

Root Cause: Account jane.doe already exists in AD
  
Fix Needed:
  - Check if account belongs to same person (correlation issue)
  - If same person: Correlate existing account
  - If different person: Use different username (jane.doe2)
  
Verification:
  Get-ADUser -Identity jane.doe
  Check when account was created
  Verify if it's the same employee
```

---

**Search for Event 3: Bob Wilson - 11:30:12**
```bash
grep "bob.wilson" connector.log | grep "2024-02-13 11:3[0-9]"
grep -C 15 "bob.wilson" connector.log | grep "2024-02-13 11:"
```

**Results:**
```
2024-02-13 11:30:10 DEBUG [AD-Connector] Creating user: bob.wilson
2024-02-13 11:30:10 DEBUG [AD-Connector] Target OU: OU=IT,OU=Users,DC=company,DC=com
2024-02-13 11:30:11 DEBUG [AD-Connector] Building PowerShell command
2024-02-13 11:30:11 DEBUG [AD-Connector] Required attributes: givenName=Bob, sn=null
2024-02-13 11:30:11 ERROR [AD-Connector] Missing required attribute: sn (surname)
2024-02-13 11:30:12 ERROR [AD-Connector] Cannot create account without last name
2024-02-13 11:30:12 ERROR [AD-Connector] Account creation failed

Root Cause: Last name (sn) is null/missing
  
Fix Needed:
  - Check identity in ISC: Does Bob Wilson have lastName?
  - If missing: Update in ISC or source system
  - Verify attribute mapping: lastName → sn
  
Verification:
  ISC → Admin → Identities → Search: Bob Wilson
  Check lastName attribute
```

---

**Search for Event 4: Alice Johnson - 14:15:33**
```bash
grep "alice.johnson" connector.log | grep "2024-02-13 14:1[0-9]"
grep -C 15 "alice.johnson" connector.log | grep "2024-02-13 14:"
```

**Results:**
```
2024-02-13 14:15:31 DEBUG [AD-Connector] Creating user: alice.johnson
2024-02-13 14:15:31 DEBUG [AD-Connector] Department: Engineering
2024-02-13 14:15:31 DEBUG [AD-Connector] Target OU: OU=Engineering,OU=Users,DC=company,DC=com
2024-02-13 14:15:32 DEBUG [AD-Connector] Executing: New-ADUser -Name "alice.johnson" -Path "OU=Engineering,OU=Users,DC=company,DC=com"
2024-02-13 14:15:33 ERROR [AD-Connector] PowerShell execution failed
2024-02-13 14:15:33 ERROR [AD-Connector] Error: New-ADUser : Insufficient access rights to perform the operation
2024-02-13 14:15:33 ERROR [AD-Connector] LDAP Error 50: INSUFFICIENT_ACCESS_RIGHTS
2024-02-13 14:15:33 ERROR [AD-Connector] Failed OU: OU=Engineering,OU=Users,DC=company,DC=com
2024-02-13 14:15:33 ERROR [AD-Connector] Service Account: svc_sailpoint

Root Cause: Service account lacks create permissions on Engineering OU
  
Fix Needed:
  - Grant create permissions to svc_sailpoint on OU=Engineering
  - Verify AD delegation
  - May work for other OUs but not Engineering
  
Verification:
  Check AD permissions on OU=Engineering
  Verify svc_sailpoint has "Create User Objects" permission
  
Action:
  AD Users and Computers → OU=Engineering → Delegate Control
  Add svc_sailpoint with Create/Delete/Manage User Accounts
```

---

**Search for Event 5: Mike Davis - 15:45:18**
```bash
grep "mike.davis" connector.log | grep "2024-02-13 15:4[0-9]"
grep -C 15 "mike.davis" connector.log | grep "2024-02-13 15:"
```

**Results:**
```
2024-02-13 15:45:16 DEBUG [AD-Connector] Creating user: mike.davis
2024-02-13 15:45:16 DEBUG [AD-Connector] Department: Sales
2024-02-13 15:45:16 DEBUG [AD-Connector] Target OU: OU=Salse,OU=Users,DC=company,DC=com
2024-02-13 15:45:17 DEBUG [AD-Connector] Executing: New-ADUser -Name "mike.davis" -Path "OU=Salse,OU=Users,DC=company,DC=com"
2024-02-13 15:45:18 ERROR [AD-Connector] PowerShell execution failed
2024-02-13 15:45:18 ERROR [AD-Connector] Error: New-ADUser : The object 'OU=Salse,OU=Users,DC=company,DC=com' cannot be found
2024-02-13 15:45:18 ERROR [AD-Connector] LDAP Error 32: NO_SUCH_OBJECT
2024-02-13 15:45:18 ERROR [AD-Connector] Failed OU: OU=Salse,OU=Users,DC=company,DC=com

Root Cause: Typo in OU name - "Salse" instead of "Sales"
  
Fix Needed:
  - Fix OU mapping in provisioning policy
  - Department "Sales" should map to OU=Sales (not OU=Salse)
  - Typo in configuration
  
Verification:
  Check provisioning policy OU mappings
  Correct: Department=Sales → OU=Sales,OU=Users,DC=company,DC=com
  
Action:
  Update OU placement rule
  Test with new account creation
```

---

**STEP 5: Summarize Findings**

**Complete Error Analysis:**
```
5 Failed Account Creations on 2024-02-13:

Failure 1: John Smith (09:15:22)
  Error: Missing department attribute
  Root Cause: Department = null
  Impact: Cannot determine target OU
  Fix: Populate department in source/ISC
  
Failure 2: Jane Doe (10:22:45)
  Error: LDAP Error 68 - Entry already exists
  Root Cause: Account jane.doe already in AD
  Impact: Duplicate creation attempt
  Fix: Correlate existing account or use jane.doe2
  
Failure 3: Bob Wilson (11:30:12)
  Error: Missing last name
  Root Cause: lastName = null
  Impact: Cannot create account without surname
  Fix: Populate lastName in source/ISC
  
Failure 4: Alice Johnson (14:15:33)
  Error: LDAP Error 50 - Insufficient access rights
  Root Cause: Service account lacks permission on Engineering OU
  Impact: Cannot create accounts in Engineering OU
  Fix: Grant permissions to svc_sailpoint
  
Failure 5: Mike Davis (15:45:18)
  Error: LDAP Error 32 - No such object
  Root Cause: Typo in OU mapping (Salse vs Sales)
  Impact: OU path does not exist
  Fix: Correct OU mapping configuration
```

**Error Categories:**
```
Data Quality Issues (3):
  ✓ Missing department (John Smith)
  ✓ Missing last name (Bob Wilson)
  ✓ Duplicate account (Jane Doe)
  
Configuration Issues (2):
  ✓ Missing permissions (Alice Johnson)
  ✓ Typo in OU mapping (Mike Davis)
```

---

**STEP 6: Remediation Plan**

**Priority 1: Configuration Fixes (Affects Multiple Users)**

**Fix 1: Correct OU Mapping Typo**
```
Issue: OU=Salse should be OU=Sales
Impact: All Sales department users will fail

Action:
  1. ISC → Admin → Connections → Sources → Active Directory
  2. Provisioning → OU Placement Rules
  3. Find: Department=Sales → OU=Salse,OU=Users,DC=company,DC=com
  4. Correct to: OU=Sales,OU=Users,DC=company,DC=com
  5. Save configuration
  6. Retry Mike Davis account creation
  7. Monitor future Sales creations

Estimated Time: 5 minutes
Urgency: High (affects all Sales users)
```

**Fix 2: Grant Permissions on Engineering OU**
```
Issue: Service account cannot create in Engineering OU
Impact: All Engineering department users will fail

Action:
  1. Open AD Users and Computers
  2. Navigate to OU=Engineering,OU=Users,DC=company,DC=com
  3. Right-click → Delegate Control
  4. Add: svc_sailpoint
  5. Grant: Create, delete, and manage user accounts
  6. Grant: Reset user passwords
  7. Apply and close
  8. Retry Alice Johnson account creation
  9. Test with another Engineering user

Estimated Time: 10 minutes
Urgency: High (affects all Engineering users)
```

---

**Priority 2: Data Quality Fixes (Individual Users)**

**Fix 3: Populate Missing Attributes**
```
Issue: John Smith missing department
Issue: Bob Wilson missing last name

Action for John Smith:
  1. Check in source system (Workday)
     - Is department populated?
     - If yes: Re-aggregate
     - If no: Update in Workday
  2. Or update manually in ISC
     - ISC → Identities → John Smith
     - Edit → department = "IT" (or appropriate)
     - Save
  3. Retry account creation

Action for Bob Wilson:
  1. Check in source system
     - Is lastName populated?
     - If yes: Re-aggregate
     - If no: Update in source
  2. Or update manually in ISC
     - ISC → Identities → Bob Wilson
     - Edit → lastName = "Wilson"
     - Save
  3. Retry account creation

Estimated Time: 15 minutes each
Urgency: Medium (individual users)
```

**Fix 4: Resolve Duplicate Account**
```
Issue: Jane Doe account already exists in AD

Action:
  1. Verify existing account in AD
     Get-ADUser -Identity jane.doe
     Check: whenCreated, description, employeeID
     
  2. Determine if same person
     - If same person → Correlation issue
     - If different person → Naming conflict
     
  3a. If same person (correlation issue):
     - ISC → Identities → Jane Doe
     - Manually link to existing AD account
     - Update correlation rules to prevent future issues
     
  3b. If different person (naming conflict):
     - Generate different username (jane.doe2)
     - Update identity.uid in ISC
     - Retry account creation

Estimated Time: 20 minutes
Urgency: Medium (individual user)
```

---

**STEP 7: Verify Fixes and Prevent Recurrence**

**Verification:**
```
1. Retry all 5 failed account creations
   - Mike Davis (after OU fix)
   - Alice Johnson (after permission fix)
   - John Smith (after department fix)
   - Bob Wilson (after lastName fix)
   - Jane Doe (after correlation/rename)
   
2. Verify all succeed
   - Check ISC Activity
   - Verify accounts in AD
   
3. Monitor for new failures
   - Watch Activity Search for next 24 hours
   - Ensure no similar failures
```

**Prevention:**
```
1. Data Quality
   - Add validation: Require department, lastName before provisioning
   - Alert on null values
   - Regular data quality checks
   
2. Configuration
   - Test OU mappings in sandbox first
   - Peer review configuration changes
   - Document all OU mappings
   
3. Permissions
   - Verify permissions on all OUs
   - Document required permissions
   - Monitor for permission changes
   
4. Correlation
   - Improve correlation logic
   - Regular correlation audits
   - Handle conflicts automatically where possible
```

---

**STEP 8: Documentation**

**Incident Report:**
```
Incident: 5 AD Account Creation Failures - 2024-02-13

Root Causes Identified:
  1. Configuration typo: OU mapping (1 failure)
  2. Missing permissions: Engineering OU (1 failure)
  3. Data quality: Missing attributes (2 failures)
  4. Correlation issue: Duplicate account (1 failure)

Fixes Applied:
  1. Corrected OU=Salse to OU=Sales
  2. Granted permissions on Engineering OU
  3. Updated missing attributes in ISC
  4. Correlated existing account

Results:
  ✓ All 5 accounts successfully created
  ✓ Issues resolved
  ✓ Monitoring for recurrence

Prevention:
  - Added data validation checks
  - Documented OU mappings
  - Verified permissions on all OUs
  - Improved correlation logic

Time to Resolution: 2 hours
```

**Exam Tip:** For multiple failures, search ISC Activity first for high-level view, then search VA logs for detailed errors. Categorize errors (data quality, configuration, permissions) and prioritize fixes by impact (configuration fixes help multiple users, data quality fixes help individuals).
</details>

---

## Section Summary

**Core Concepts for Certification:**

✅ **Search Locations:**
- **ISC UI**: Admin → Activity → Search (high-level errors)
- **VA Logs**: /opt/sailpoint/logs/connector.log (detailed errors)

✅ **ISC Activity Search:**
- Filter by: Type (Provisioning), Status (Failed), Source, Date Range
- Provides: Event summary, generic error messages
- Best for: Quick overview, identifying patterns

✅ **VA Log Search:**
- Tools: grep (Linux), Select-String (PowerShell)
- Search by: Identity name, timestamp, error type
- Provides: Detailed errors, exact commands, full context
- Best for: Root cause analysis, detailed diagnosis

✅ **Common Error Patterns:**
- **LDAP 68**: Entry already exists (duplicate account)
- **LDAP 50**: Insufficient access (permission issue)
- **LDAP 32**: No such object (invalid OU/DN)
- **LDAP 34**: Invalid DN syntax (malformed DN)
- **HTTP 401**: Unauthorized (authentication failed)
- **HTTP 429**: Rate limit exceeded (too many requests)

✅ **Search Strategy:**
1. Search ISC Activity (high-level view)
2. Identify patterns (single vs. multiple, specific errors)
3. Search VA logs (detailed errors)
4. Correlate ISC events with VA log entries
5. Analyze detailed errors
6. Determine root cause
7. Plan remediation

✅ **Correlation Technique:**
- Note timestamp from ISC event
- Search VA logs around same time (±5 minutes)
- Search for identity/account name
- Match ISC event to VA log entry
- Get detailed error from VA logs

**Exam Focus Areas:**
- Know ISC Activity shows high-level errors
- Understand VA logs have detailed errors
- Remember grep/Select-String for searching logs
- Know common LDAP error codes and meanings
- Understand correlation between ISC and VA logs
- Know to search by timestamp and identity name
- Remember LDAP 68 = duplicate, 50 = permission, 32 = not found

---

**End of Section 5.4.3: Searching for Provisioning Errors**

**Next:** Section 5.4.4: Reading Provisioning Logs and Events

---

**Study Tips:**
- **ISC first**: Quick overview of failures
- **VA logs second**: Detailed diagnosis
- **Search by**: Timestamp, identity name, error type
- **Common errors**: LDAP 68/50/32, HTTP 401/429/500
- **Tools**: grep (Linux), Select-String (Windows)
- **Context**: Use -C option to see surrounding lines
- **Correlation**: Match timestamp from ISC to VA logs
