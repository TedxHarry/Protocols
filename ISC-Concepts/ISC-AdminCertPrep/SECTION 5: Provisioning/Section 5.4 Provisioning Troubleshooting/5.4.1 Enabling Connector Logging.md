# 5.4.1 Enabling Connector Logging

**Learning Objective:** Understand how to enable and configure logging for provisioning connectors to troubleshoot issues.

---

## What is Connector Logging?

**Definition:** Detailed recording of connector activities, operations, and errors for troubleshooting and monitoring

**Purpose:**
```
Connector logs capture:
  - Provisioning operations (create, update, delete)
  - API calls and responses
  - Errors and failures
  - Performance metrics
  - Communication between ISC and sources
```

**Why enable logging:**
```
✓ Troubleshoot provisioning failures
✓ Debug configuration issues
✓ Investigate performance problems
✓ Audit provisioning activities
✓ Support case documentation
✓ Root cause analysis
```

**Exam Tip:** Connector logging records all connector activity. Enable it to troubleshoot provisioning issues. Different log levels provide different detail.

---

## Logging Architecture

### **Where Logs Are Generated**

**Cloud Connectors (Direct API):**
```
ISC Cloud → Connector → Target API

Logs stored in:
  ✓ ISC platform (cloud)
  ✓ Accessible via ISC UI
  ✓ API accessible
  ✓ No local storage
```

**VA Connectors (On-Premises):**
```
ISC Cloud → VA → Connector → Target System

Logs stored in:
  ✓ VA file system (local)
  ✓ Path: /opt/sailpoint/logs/ (Linux)
  ✓ Path: C:\sailpoint\logs\ (Windows)
  ✓ Also sent to ISC (summary)
```

### **Log Types**

**ISC Platform Logs:**
```
Location: ISC UI and API

Contains:
  - Provisioning events
  - Operation results (success/failure)
  - High-level errors
  - Performance metrics
  - Audit trail

Access:
  Admin → Activity → Search
  Filter by provisioning events
```

**Connector Logs (VA):**
```
Location: VA file system

Files:
  - connector.log (connector operations)
  - va.log (VA service operations)
  - ccg.log (ISC communication)

Contains:
  - Detailed connector operations
  - API requests/responses
  - LDAP/JDBC operations
  - Error details and stack traces
  - Debug information
```

---

## Enabling Logging in ISC

### **Cloud Connector Logging**

**For Direct API Connectors (Salesforce, ServiceNow, etc.):**

**Step 1: Navigate to Source**
```
ISC UI:
  Admin → Connections → Sources
  Select source (e.g., Salesforce)
```

**Step 2: Enable Logging**
```
Source Configuration:
  Click on source name
  Settings or Advanced section
  Find: "Enable Debug Logging" or "Logging Level"
  
Options:
  - Disabled (default)
  - Info (standard)
  - Debug (detailed)
  - Trace (very detailed)
```

**Step 3: Set Log Level**
```
Logging Levels:

ERROR (least verbose):
  ✓ Only errors logged
  ✓ Minimal overhead
  ✓ Not useful for troubleshooting
  
WARN:
  ✓ Warnings and errors
  ✓ Some operational issues
  ✓ Still limited detail
  
INFO:
  ✓ Informational messages
  ✓ Operation summaries
  ✓ Good for general monitoring
  
DEBUG (recommended for troubleshooting):
  ✓ Detailed operation logs
  ✓ API requests/responses
  ✓ Connection details
  ✓ Useful for troubleshooting
  
TRACE (most verbose):
  ✓ Very detailed logging
  ✓ Every step logged
  ✓ Large log files
  ✓ Use sparingly
```

**Step 4: Save and Apply**
```
After setting log level:
  1. Save configuration
  2. Changes take effect immediately
  3. Next provisioning operation will log at new level
  4. No restart required (cloud connectors)
```

**Example Configuration:**
```
Source: Salesforce

Configuration:
  Source Name: Salesforce Production
  Connection Type: Direct API
  
Logging Settings:
  Enable Logging: Yes
  Log Level: DEBUG
  
  Applied to:
    - All provisioning operations
    - API calls to Salesforce
    - Error details
    
Result:
  Next provisioning operation logs detailed information
```

---

## Enabling Logging on Virtual Appliance

### **VA Connector Logging**

**For VA-based Connectors (Active Directory, Oracle, etc.):**

**Step 1: Access VA Configuration**
```
Methods to configure VA logging:

Option A: ISC UI (Preferred)
  Admin → Virtual Appliances
  Select VA (e.g., VA-PROD-01)
  Configuration → Logging
  
Option B: VA Local Configuration
  SSH/RDP to VA
  Edit configuration files
  Restart VA service
  
Option C: Command Line (Advanced)
  Use VA CLI commands
  For troubleshooting
```

**Step 2: Enable Connector Logging via ISC UI**
```
ISC UI Path:
  Admin → Virtual Appliances → VA-PROD-01
  
Logging Configuration:
  Connector Logging:
    Level: DEBUG
    
  VA Service Logging:
    Level: INFO
    
  Communication Logging:
    Level: INFO
```

**Step 3: Configure via VA Configuration File**
```
Location (Linux VA):
  /opt/sailpoint/share/config/connector.properties

Location (Windows VA):
  C:\sailpoint\share\config\connector.properties

Edit file:
  # Connector Logging Level
  connector.log.level=DEBUG
  
  # Specific Connector Logging
  connector.ad.log.level=DEBUG
  connector.jdbc.log.level=INFO
  
  # VA Service Logging
  va.log.level=INFO
```

**Step 4: Apply Configuration**
```
After editing configuration:

If using ISC UI:
  ✓ Save changes
  ✓ VA picks up changes automatically
  ✓ No restart needed
  
If editing config file directly:
  1. Save file
  2. Restart VA service:
     
     Linux:
       sudo systemctl restart ccg
       
     Windows:
       Restart-Service "SailPoint Cloud Connector Gateway"
       
  3. Verify service running
  4. Check logs for restart confirmation
```

---

## Connector-Specific Logging

### **Active Directory Connector**

**Enabling AD Connector Logging:**
```
Configuration File: connector.properties

Settings:
  # Active Directory Connector
  connector.ad.log.level=DEBUG
  
  # Log LDAP operations
  connector.ad.log.ldap=true
  
  # Log PowerShell commands
  connector.ad.log.powershell=true
  
  # Log group operations
  connector.ad.log.groups=true
```

**What gets logged:**
```
DEBUG level logs:
  ✓ LDAP bind operations
  ✓ LDAP search queries
  ✓ PowerShell commands executed
  ✓ Account creation details
  ✓ Group membership changes
  ✓ Attribute modifications
  ✓ Error details and stack traces
```

**Example log output:**
```
2024-02-14 10:30:15 DEBUG [AD-Connector] LDAP bind: dc01.company.com:636
2024-02-14 10:30:15 DEBUG [AD-Connector] Bind DN: CN=svc_sailpoint,OU=Service,DC=company,DC=com
2024-02-14 10:30:15 DEBUG [AD-Connector] Bind successful
2024-02-14 10:30:16 DEBUG [AD-Connector] Creating user: john.smith
2024-02-14 10:30:16 DEBUG [AD-Connector] Executing: New-ADUser -Name "john.smith" -GivenName "John" -Surname "Smith"...
2024-02-14 10:30:17 DEBUG [AD-Connector] User created successfully: CN=john.smith,OU=Users,DC=company,DC=com
2024-02-14 10:30:17 DEBUG [AD-Connector] Adding to group: VPN-Users
2024-02-14 10:30:17 DEBUG [AD-Connector] Executing: Add-ADGroupMember -Identity "VPN-Users" -Members "john.smith"
2024-02-14 10:30:18 DEBUG [AD-Connector] Group membership added successfully
```

---

### **JDBC Connector (Database)**

**Enabling JDBC Connector Logging:**
```
Configuration File: connector.properties

Settings:
  # JDBC Connector
  connector.jdbc.log.level=DEBUG
  
  # Log SQL statements
  connector.jdbc.log.sql=true
  
  # Log result sets
  connector.jdbc.log.results=true
  
  # Log connection details
  connector.jdbc.log.connections=true
```

**What gets logged:**
```
DEBUG level logs:
  ✓ Database connection details
  ✓ SQL statements executed
  ✓ Query parameters
  ✓ Result set data
  ✓ Transaction details
  ✓ Errors and exceptions
```

**Example log output:**
```
2024-02-14 10:30:15 DEBUG [JDBC-Connector] Connecting to: jdbc:oracle:thin:@oracledb:1521:PROD
2024-02-14 10:30:15 DEBUG [JDBC-Connector] Connection successful
2024-02-14 10:30:16 DEBUG [JDBC-Connector] Executing SQL: INSERT INTO users (user_id, username, first_name, last_name, email, dept) VALUES (?, ?, ?, ?, ?, ?)
2024-02-14 10:30:16 DEBUG [JDBC-Connector] Parameters: [12345, 'john.smith', 'John', 'Smith', 'john.smith@company.com', 'Sales']
2024-02-14 10:30:17 DEBUG [JDBC-Connector] Rows affected: 1
2024-02-14 10:30:17 DEBUG [JDBC-Connector] Commit successful
```

---

### **Salesforce Connector (Cloud)**

**Enabling Salesforce Connector Logging:**
```
ISC UI:
  Admin → Connections → Sources → Salesforce
  
Settings:
  Advanced → Logging
  Log Level: DEBUG
  
  Options:
    ☑ Log API Requests
    ☑ Log API Responses
    ☑ Log Authentication
    ☐ Log SOQL Queries (optional)
```

**What gets logged:**
```
DEBUG level logs:
  ✓ OAuth authentication flow
  ✓ API endpoints called
  ✓ Request payloads (JSON)
  ✓ Response payloads (JSON)
  ✓ HTTP status codes
  ✓ Error messages
  ✓ Rate limit information
```

**Example log output:**
```
2024-02-14 10:30:15 INFO [SF-Connector] Authenticating to Salesforce
2024-02-14 10:30:15 DEBUG [SF-Connector] OAuth token request
2024-02-14 10:30:16 DEBUG [SF-Connector] OAuth token received, expires in 7200 seconds
2024-02-14 10:30:16 DEBUG [SF-Connector] POST /services/data/v58.0/sobjects/User
2024-02-14 10:30:16 DEBUG [SF-Connector] Request: {"Username":"john.smith@company.com","Email":"john.smith@company.com","LastName":"Smith","FirstName":"John","Alias":"jsmith","ProfileId":"00exx000001abcd"}
2024-02-14 10:30:17 DEBUG [SF-Connector] Response: HTTP 201 Created
2024-02-14 10:30:17 DEBUG [SF-Connector] Response: {"id":"005xx000001234AAA","success":true}
2024-02-14 10:30:17 INFO [SF-Connector] User created successfully: 005xx000001234AAA
```

---

## Viewing Connector Logs

### **ISC UI (Cloud Connectors)**

**Accessing logs in ISC:**
```
Path 1: Activity Search
  Admin → Activity → Search
  
  Filters:
    Type: Provisioning
    Source: [Select source]
    Status: All (or Failed for errors)
    Date Range: Last 7 days
    
  Results show:
    - Provisioning events
    - Success/failure status
    - Error messages
    - Timestamps

Path 2: Source Events
  Admin → Connections → Sources → [Source]
  Events tab
  
  Shows recent events for this source:
    - Aggregations
    - Provisioning operations
    - Errors
```

**Viewing Event Details:**
```
In Activity Search results:
  1. Click on event
  2. View details panel
  
  Details include:
    - Operation (Create, Update, Delete)
    - Target account
    - Attributes changed
    - Result (Success/Failure)
    - Error message (if failed)
    - Stack trace (if available)
    - Timestamp
    - Duration
```

---

### **VA Logs (On-Premises Connectors)**

**Accessing VA logs:**

**Method 1: VA UI Dashboard (if available)**
```
VA Web Interface:
  https://va-hostname:9090
  
  Navigation:
    Logs → Connector Logs
    
  View:
    - Real-time log streaming
    - Filter by level
    - Search logs
    - Download logs
```

**Method 2: File System Access**
```
SSH/RDP to VA:

Linux VA:
  Log location: /opt/sailpoint/logs/
  
  Files:
    connector.log - Current connector log
    connector.log.1 - Yesterday's log
    connector.log.2.gz - Older logs (compressed)
    va.log - VA service log
    ccg.log - ISC communication log
    
  View logs:
    tail -f /opt/sailpoint/logs/connector.log
    less /opt/sailpoint/logs/connector.log
    grep "ERROR" /opt/sailpoint/logs/connector.log
    
Windows VA:
  Log location: C:\sailpoint\logs\
  
  Files:
    connector.log
    connector.log.1
    connector.log.2
    va.log
    ccg.log
    
  View logs:
    Get-Content C:\sailpoint\logs\connector.log -Tail 100
    Select-String "ERROR" C:\sailpoint\logs\connector.log
```

**Method 3: Download from ISC UI**
```
ISC UI:
  Admin → Virtual Appliances → VA-PROD-01
  
  Actions:
    Download Logs
    
  Downloads zip file containing:
    - connector.log
    - va.log
    - ccg.log
    - Configuration files (sanitized)
    
  Extract and analyze locally
```

---

## Log Rotation and Retention

### **Automatic Log Rotation**

**VA Log Rotation:**
```
Default Configuration:
  Current log: connector.log (actively written)
  Daily rotation: connector.log → connector.log.1
  Compression: connector.log.2 → connector.log.2.gz
  
Rotation Schedule:
  Frequency: Daily (midnight)
  Keep: 7 daily logs
  Compress: After 2 days
  Delete: After 7 days
  
Size-based rotation:
  Max size: 100 MB
  If log exceeds: Rotate immediately
```

**Cloud Connector Log Retention:**
```
ISC Platform:
  Retention: 90 days
  After 90 days: Logs archived or deleted
  
Download logs before 90 days if needed for long-term storage
```

---

## Best Practices for Logging

### **When to Enable Debug Logging**

**Enable DEBUG when:**
```
✓ Troubleshooting provisioning failures
✓ Testing new connector configuration
✓ Investigating performance issues
✓ Working with SailPoint support
✓ Diagnosing integration problems
```

**Disable DEBUG when:**
```
✓ Issue resolved
✓ Normal operations
✓ Production environment (use INFO)
✓ Performance concerns
✓ Disk space concerns
```

---

### **Logging Levels Strategy**

**Production Environment:**
```
Default Levels:
  Connector: INFO
  VA Service: INFO
  Communication: WARN
  
Rationale:
  ✓ Captures important events
  ✓ Minimal performance impact
  ✓ Reasonable log size
  ✓ Sufficient for monitoring
```

**Troubleshooting:**
```
Temporary Levels:
  Connector: DEBUG
  VA Service: INFO
  Communication: DEBUG (if needed)
  
Duration:
  ✓ Enable for specific issue
  ✓ Collect logs
  ✓ Revert to INFO when done
  
Rationale:
  ✓ Detailed information for diagnosis
  ✓ Short-term use (limit log growth)
  ✓ Return to normal after resolution
```

---

### **Log Management**

**Monitoring log size:**
```
VA Logs:
  Check disk space:
    df -h /opt/sailpoint/logs (Linux)
    
  Alert if:
    ✓ Logs exceed 1 GB
    ✓ Disk space < 10% free
    ✓ Log growth abnormal
```

**Log archiving:**
```
Long-term retention:
  1. Download logs from VA
  2. Compress (tar.gz or zip)
  3. Store in central logging system
  4. Or store in backup location
  
Schedule:
  ✓ Weekly for production
  ✓ Before/after major changes
  ✓ When troubleshooting
```

---

## Practice Exercise

**Question:** You're troubleshooting a failed AD account creation. The ISC UI shows "Account creation failed" but no details. What logging would you enable and where would you check for more information?

<details>
<summary>Answer</summary>

**Troubleshooting Process:**

---

**Step 1: Enable Detailed Logging**

**Action: Enable DEBUG logging on AD connector**

**Method A: Via ISC UI (Preferred)**
```
1. Navigate to Virtual Appliance
   Admin → Virtual Appliances
   Select: VA-PROD-01 (the VA handling AD)
   
2. Configure Connector Logging
   Settings → Logging
   
   Set:
     Active Directory Connector: DEBUG
     Log LDAP Operations: Enabled
     Log PowerShell Commands: Enabled
     
3. Save Configuration
   Changes apply immediately
   No VA restart needed
```

**Method B: Via VA Configuration File**
```
If ISC UI not available:

1. SSH/RDP to VA
   ssh admin@va-prod-01
   
2. Edit connector configuration
   sudo nano /opt/sailpoint/share/config/connector.properties
   
3. Set logging level
   # Enable DEBUG logging for AD connector
   connector.ad.log.level=DEBUG
   connector.ad.log.ldap=true
   connector.ad.log.powershell=true
   
4. Save file
   Ctrl+O, Enter, Ctrl+X
   
5. Restart VA service
   sudo systemctl restart ccg
   
6. Verify service running
   sudo systemctl status ccg
```

---

**Step 2: Reproduce the Issue**

**Action: Trigger another account creation attempt**
```
Option A: Retry Provisioning (Recommended)
  1. ISC UI → Admin → Activity
  2. Find failed provisioning event
  3. Click on event
  4. Click "Retry" button
  5. Provisioning attempts again with DEBUG logging
  
Option B: Trigger New Provisioning
  1. Create test identity
  2. Trigger joiner workflow
  3. Attempt AD account creation
  4. Capture detailed logs
  
Option C: Manual Test
  1. ISC → Admin → Connections → Sources → Active Directory
  2. Test Connection → Test Account Creation
  3. Attempt to create test account
  4. Review logs
```

---

**Step 3: Check ISC Activity Logs**

**Action: Review high-level error in ISC UI**
```
1. Navigate to Activity Search
   Admin → Activity → Search
   
2. Filter for provisioning events
   Type: Provisioning
   Source: Active Directory
   Status: Failed
   Date Range: Last 1 hour
   
3. Find the failed event
   Click on most recent failure
   
4. Review event details
   Details panel shows:
     - Operation: Create Account
     - Target: john.smith
     - Status: Failed
     - Error: "Account creation failed"
     - Error Code: (if provided)
     
5. Look for additional details
   Expand: Error Details
   Check for:
     - Stack trace
     - Error code
     - Specific error message
```

**What you might find:**
```
Example 1: Generic Error
  Error: "Account creation failed"
  Details: None
  
  → Need to check VA logs for details
  
Example 2: Specific Error
  Error: "LDAP Error 68: Entry Already Exists"
  Details: "The account john.smith already exists in AD"
  
  → May be sufficient, but VA logs provide more context
  
Example 3: Permission Error
  Error: "LDAP Error 50: Insufficient Access Rights"
  Details: "Service account lacks permission to create in OU"
  
  → Indicates permissions issue, VA logs show exact operation
```

---

**Step 4: Check VA Connector Logs**

**Action: Review detailed connector logs on VA**

**Method A: Download Logs from ISC UI**
```
1. Navigate to Virtual Appliance
   Admin → Virtual Appliances → VA-PROD-01
   
2. Download Logs
   Actions → Download Logs
   
3. Extract downloaded zip file
   Contains:
     - connector.log (most important)
     - va.log
     - ccg.log
     
4. Open connector.log
   Search for timestamp of failure
   Look for ERROR or WARN entries
```

**Method B: Access Logs Directly on VA**
```
1. SSH to VA
   ssh admin@va-prod-01
   
2. Navigate to logs directory
   cd /opt/sailpoint/logs
   
3. View recent connector log
   tail -f connector.log
   
   Or search for errors:
   grep "ERROR" connector.log | tail -20
   
4. Look for account creation attempt
   grep "john.smith" connector.log
   
5. View context around error
   grep -A 10 -B 5 "john.smith" connector.log
   (Shows 5 lines before, 10 lines after)
```

---

**Step 5: Analyze Connector Logs**

**What to look for in connector.log:**

**Successful Flow (for comparison):**
```
2024-02-14 10:30:15 DEBUG [AD-Connector] Starting account creation
2024-02-14 10:30:15 DEBUG [AD-Connector] LDAP bind: dc01.company.com:636
2024-02-14 10:30:15 DEBUG [AD-Connector] Bind DN: CN=svc_sailpoint,OU=Service,DC=company,DC=com
2024-02-14 10:30:15 DEBUG [AD-Connector] Bind successful
2024-02-14 10:30:16 DEBUG [AD-Connector] Creating user: john.smith
2024-02-14 10:30:16 DEBUG [AD-Connector] Target OU: OU=Sales,OU=Users,DC=company,DC=com
2024-02-14 10:30:16 DEBUG [AD-Connector] Executing: New-ADUser -Name "john.smith" -GivenName "John" -Surname "Smith" -SamAccountName "john.smith" -Path "OU=Sales,OU=Users,DC=company,DC=com" -Enabled $true
2024-02-14 10:30:17 DEBUG [AD-Connector] PowerShell execution successful
2024-02-14 10:30:17 DEBUG [AD-Connector] User created: CN=john.smith,OU=Sales,OU=Users,DC=company,DC=com
2024-02-14 10:30:17 INFO [AD-Connector] Account creation successful
```

**Failed Flow - Example 1: Entry Already Exists**
```
2024-02-14 10:30:15 DEBUG [AD-Connector] Starting account creation
2024-02-14 10:30:15 DEBUG [AD-Connector] LDAP bind: dc01.company.com:636
2024-02-14 10:30:15 DEBUG [AD-Connector] Bind successful
2024-02-14 10:30:16 DEBUG [AD-Connector] Creating user: john.smith
2024-02-14 10:30:16 DEBUG [AD-Connector] Target OU: OU=Sales,OU=Users,DC=company,DC=com
2024-02-14 10:30:16 DEBUG [AD-Connector] Executing: New-ADUser -Name "john.smith" ...
2024-02-14 10:30:17 ERROR [AD-Connector] PowerShell execution failed
2024-02-14 10:30:17 ERROR [AD-Connector] Error: New-ADUser : The specified account already exists
2024-02-14 10:30:17 ERROR [AD-Connector] LDAP Error 68: ENTRY_ALREADY_EXISTS
2024-02-14 10:30:17 ERROR [AD-Connector] DN: CN=john.smith,OU=Sales,OU=Users,DC=company,DC=com
2024-02-14 10:30:17 ERROR [AD-Connector] Account creation failed

Root Cause: Account john.smith already exists in AD
Solution: 
  - Check if account exists in AD
  - If exists, correlate instead of create
  - Or use different username (john.smith2)
```

**Failed Flow - Example 2: Insufficient Permissions**
```
2024-02-14 10:30:15 DEBUG [AD-Connector] Starting account creation
2024-02-14 10:30:15 DEBUG [AD-Connector] LDAP bind: dc01.company.com:636
2024-02-14 10:30:15 DEBUG [AD-Connector] Bind DN: CN=svc_sailpoint,OU=Service,DC=company,DC=com
2024-02-14 10:30:15 DEBUG [AD-Connector] Bind successful
2024-02-14 10:30:16 DEBUG [AD-Connector] Creating user: john.smith
2024-02-14 10:30:16 DEBUG [AD-Connector] Target OU: OU=Sales,OU=Users,DC=company,DC=com
2024-02-14 10:30:16 DEBUG [AD-Connector] Executing: New-ADUser -Name "john.smith" ...
2024-02-14 10:30:17 ERROR [AD-Connector] PowerShell execution failed
2024-02-14 10:30:17 ERROR [AD-Connector] Error: New-ADUser : Insufficient access rights to perform the operation
2024-02-14 10:30:17 ERROR [AD-Connector] LDAP Error 50: INSUFFICIENT_ACCESS_RIGHTS
2024-02-14 10:30:17 ERROR [AD-Connector] Failed OU: OU=Sales,OU=Users,DC=company,DC=com
2024-02-14 10:30:17 ERROR [AD-Connector] Service Account: svc_sailpoint
2024-02-14 10:30:17 ERROR [AD-Connector] Account creation failed

Root Cause: Service account lacks create permissions on Sales OU
Solution:
  - Grant create permissions to svc_sailpoint on OU=Sales
  - Or change target OU to one with permissions
  - Verify AD delegation
```

**Failed Flow - Example 3: Missing Required Attribute**
```
2024-02-14 10:30:15 DEBUG [AD-Connector] Starting account creation
2024-02-14 10:30:15 DEBUG [AD-Connector] LDAP bind successful
2024-02-14 10:30:16 DEBUG [AD-Connector] Creating user: john.smith
2024-02-14 10:30:16 DEBUG [AD-Connector] Attributes: sAMAccountName=john.smith, givenName=John, sn=null
2024-02-14 10:30:16 DEBUG [AD-Connector] Executing: New-ADUser ...
2024-02-14 10:30:17 ERROR [AD-Connector] PowerShell execution failed
2024-02-14 10:30:17 ERROR [AD-Connector] Error: New-ADUser : Cannot validate argument on parameter 'Surname'. The argument is null or empty.
2024-02-14 10:30:17 ERROR [AD-Connector] Missing required attribute: sn (surname/last name)
2024-02-14 10:30:17 ERROR [AD-Connector] Account creation failed

Root Cause: Last name (sn) is null/missing
Solution:
  - Verify identity has lastName attribute populated
  - Check attribute mapping in identity profile
  - Ensure source provides last name
```

**Failed Flow - Example 4: Invalid OU Path**
```
2024-02-14 10:30:15 DEBUG [AD-Connector] Starting account creation
2024-02-14 10:30:15 DEBUG [AD-Connector] LDAP bind successful
2024-02-14 10:30:16 DEBUG [AD-Connector] Creating user: john.smith
2024-02-14 10:30:16 DEBUG [AD-Connector] Target OU: OU=InvalidOU,OU=Users,DC=company,DC=com
2024-02-14 10:30:16 DEBUG [AD-Connector] Executing: New-ADUser -Name "john.smith" -Path "OU=InvalidOU,OU=Users,DC=company,DC=com"
2024-02-14 10:30:17 ERROR [AD-Connector] PowerShell execution failed
2024-02-14 10:30:17 ERROR [AD-Connector] Error: New-ADUser : The object 'OU=InvalidOU,OU=Users,DC=company,DC=com' cannot be found
2024-02-14 10:30:17 ERROR [AD-Connector] LDAP Error 32: NO_SUCH_OBJECT
2024-02-14 10:30:17 ERROR [AD-Connector] Account creation failed

Root Cause: OU path does not exist in AD
Solution:
  - Verify OU exists in AD: OU=InvalidOU,OU=Users,DC=company,DC=com
  - Create OU if needed
  - Or correct OU path in provisioning policy
```

---

**Step 6: Resolution**

**Based on log analysis, take corrective action:**

**Scenario 1: Account Already Exists**
```
Problem: john.smith already exists

Resolution:
  1. Search for existing account in AD
  2. Determine if it's the same person
  3. Options:
     a. Correlate to existing account (recommended)
     b. Delete old account and recreate
     c. Use different username (john.smith2)
     
  4. Update ISC:
     - If correlating: Link account to identity
     - If new username: Update identity.uid
     - Retry provisioning
```

**Scenario 2: Insufficient Permissions**
```
Problem: Service account lacks create permissions

Resolution:
  1. Identify required OU: OU=Sales,OU=Users,DC=company,DC=com
  2. Identify service account: svc_sailpoint
  3. Grant permissions in AD:
     - Open AD Users and Computers
     - Navigate to OU=Sales
     - Right-click → Delegate Control
     - Add svc_sailpoint
     - Grant: Create, delete, and manage user accounts
  4. Test: Retry provisioning
  5. Verify: Check logs for success
```

**Scenario 3: Missing Attribute**
```
Problem: Last name (sn) is null

Resolution:
  1. Check identity in ISC:
     Admin → Identities → Search: john.smith
     Verify: lastName attribute populated
     
  2. If missing in ISC:
     - Check source system (Workday)
     - Update in source
     - Re-aggregate
     - Or manually populate in ISC
     
  3. If present in ISC but not mapping:
     - Check attribute mapping in provisioning policy
     - Verify: ISC.lastName → AD.sn
     - Update mapping if incorrect
     
  4. Retry provisioning
```

**Scenario 4: Invalid OU**
```
Problem: OU does not exist

Resolution:
  1. Create OU in AD:
     New-ADOrganizationalUnit -Name "Sales" -Path "OU=Users,DC=company,DC=com"
     
  2. Or update provisioning policy:
     - Change OU placement rule
     - Use existing valid OU
     
  3. Retry provisioning
```

---

**Step 7: Verify Resolution**

**Action: Confirm account created successfully**
```
1. Retry provisioning
   ISC → Activity → Retry failed event
   
2. Monitor logs in real-time
   VA: tail -f /opt/sailpoint/logs/connector.log
   
3. Verify success in logs
   Look for: "Account creation successful"
   
4. Verify in Active Directory
   Get-ADUser -Identity john.smith
   
   Should show:
     - Account exists
     - Correct attributes
     - In correct OU
     - Groups assigned
     
5. Verify in ISC
   Identity: John Smith
   Accounts: Active Directory - john.smith ✓
   Status: Provisioned successfully
```

---

**Step 8: Disable DEBUG Logging**

**Action: Return to normal logging levels**
```
After issue resolved:

1. Navigate to VA configuration
   Admin → Virtual Appliances → VA-PROD-01
   
2. Reset logging levels
   Active Directory Connector: INFO (from DEBUG)
   Log LDAP Operations: Disabled
   Log PowerShell Commands: Disabled
   
3. Save configuration

Why disable DEBUG:
  ✓ Reduces log volume
  ✓ Improves performance
  ✓ Saves disk space
  ✓ DEBUG only needed for troubleshooting
```

---

**Complete Troubleshooting Summary:**
```
Issue: AD account creation failed, no details in ISC UI

Actions Taken:
  1. ✓ Enabled DEBUG logging on AD connector
  2. ✓ Reproduced issue (retry provisioning)
  3. ✓ Checked ISC activity logs (generic error)
  4. ✓ Downloaded/viewed VA connector logs
  5. ✓ Analyzed detailed error in connector.log
  6. ✓ Identified root cause (e.g., permissions)
  7. ✓ Applied resolution (grant permissions)
  8. ✓ Verified fix (account created)
  9. ✓ Disabled DEBUG logging

Result:
  Account created successfully
  Issue documented for future reference
  Normal operations resumed
  
Time to Resolution: 30-60 minutes
```

**Exam Tip:** For AD provisioning failures, enable DEBUG logging on VA connector, check connector.log for detailed error (LDAP error codes, PowerShell errors), identify root cause (permissions, missing attributes, invalid OU), fix, verify, and disable DEBUG.
</details>

---

## Section Summary

**Core Concepts for Certification:**

✅ **Connector Logging Purpose:**
- Records all connector operations and errors
- Essential for troubleshooting provisioning issues
- Provides detailed diagnostic information
- Supports root cause analysis

✅ **Logging Locations:**
- **Cloud Connectors**: ISC UI (Admin → Activity)
- **VA Connectors**: VA file system (/opt/sailpoint/logs/)
- **Both**: Event logs accessible via ISC

✅ **Log Levels:**
- **ERROR**: Only errors (least verbose)
- **WARN**: Warnings and errors
- **INFO**: Informational (production default)
- **DEBUG**: Detailed debug info (troubleshooting)
- **TRACE**: Very detailed (use sparingly)

✅ **Enabling Logging:**
- **Cloud**: ISC UI source configuration
- **VA**: ISC UI VA configuration or config file
- **Apply**: Immediate (cloud) or restart (VA config file)

✅ **Key Log Files (VA):**
- **connector.log**: Connector operations (primary)
- **va.log**: VA service operations
- **ccg.log**: ISC communication

✅ **Best Practices:**
- Use INFO level in production
- Enable DEBUG only when troubleshooting
- Disable DEBUG after issue resolved
- Archive logs before they rotate
- Monitor disk space

**Exam Focus Areas:**
- Know how to enable DEBUG logging
- Understand where logs are located (cloud vs. VA)
- Know log levels and when to use each
- Remember connector.log is primary for troubleshooting
- Understand DEBUG needed for detailed errors
- Know to disable DEBUG after troubleshooting

---

**End of Section 5.4.1: Enabling Connector Logging**

**Next:** Section 5.4.2: Logging Levels and When to Use Them

---

**Study Tips:**
- **Production**: INFO level (normal operations)
- **Troubleshooting**: DEBUG level (detailed)
- **Cloud logs**: ISC UI (Admin → Activity)
- **VA logs**: /opt/sailpoint/logs/connector.log
- **Enable DEBUG**: Only when needed
- **Disable DEBUG**: After issue resolved
- **Primary log**: connector.log (most important)
